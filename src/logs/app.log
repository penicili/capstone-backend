2025-12-10 12:22:29 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:22:29 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:22:53 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:23:19 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:23:20 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:23:20 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:23:22 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:23:23 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:23:24 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:23:24 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:23:26 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:23:28 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:23:29 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:23:29 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:23:31 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:23:32 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:23:33 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:23:33 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:23:34 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:23:40 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:24:20 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:24:20 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:24:22 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:24:24 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:24:50 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:24:50 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:24:51 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:24:54 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:24:55 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:24:55 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:24:57 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:25:00 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:26:03 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:26:03 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:26:05 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:26:43 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:26:54 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:26:54 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:26:56 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:26:57 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:27:01 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:27:01 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:27:03 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:27:05 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:27:05 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:27:05 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:27:07 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:27:41 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:27:58 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:27:58 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:28:00 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:28:03 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:28:04 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:28:04 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:28:06 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:28:16 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:28:17 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:28:17 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:28:19 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:28:23 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 12:28:28 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 12:28:28 | INFO     | app:lifespan:13 - loading models...
2025-12-10 12:28:29 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 12:28:34 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:05:36 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:05:36 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:05:48 | ERROR    | services.model_service:load_models:32 - error loading models
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=13592, pipe_handle=540)
                                      │           └ <function spawn_main at 0x0000025CDEDE09A0>
                                      └ <function spawn_main at 0x0000025CDEDE09A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 324
               │     └ 3
               └ <function _main at 0x0000025CDEDE0A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 324
           │    └ <function BaseProcess._bootstrap at 0x0000025CDEA982C0>
           └ <SpawnProcess name='SpawnProcess-1' parent=13592 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000025CDEA937E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=13592 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000025CE21E8440>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=13592 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=13592 started>
    │    └ <function subprocess_started at 0x0000025CE21BB880>
    └ <SpawnProcess name='SpawnProcess-1' parent=13592 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=620, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000025CE21E8590>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x0000025CE2176E80>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x0000025CE21E8440>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x0000025CE21E8590>
           │           │    │             └ [<socket.socket fd=620, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x0000025CE21BAA20>
           │           └ <uvicorn.server.Server object at 0x0000025CE21E8590>
           └ <function run at 0x0000025CDF50CE00>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000025CDE8FBA00>
           │      └ <function Runner.run at 0x0000025CE0E6CF40>
           └ <asyncio.runners.Runner object at 0x0000025CE21E9010>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000025CE0E6A980>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000025CE21E9010>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000025CE0E6A8E0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000025CE0E6C720>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000025CDF621F80>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000025CE21E1CC0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000025CE21E1CC0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000025CE21E1CC0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000025CE21E1CC0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x0000025CE2237600>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>
          │   │      │    └ <function LifespanOn.receive at 0x0000025CE22376A0>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000025CE21EA120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x0000025CE21EF9D0>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000025CE21EA120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000025CE21EB0E0>
          └ <fastapi.applications.FastAPI object at 0x0000025CE21EF9D0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000025CE21EAF90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000025CE21EB0E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000025CE21EAE40>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000025CE21EAF90>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x0000025CE213B360>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000025CE21EAE40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000025CE213B360>>
          └ <fastapi.routing.APIRouter object at 0x0000025CE213B360>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000025CE21EA900>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x0000025CE1EF9B20>
          └ <fastapi.routing.APIRouter object at 0x0000025CE213B360>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x0000025CE21EF9D0>
               │    └ <function lifespan at 0x0000025CE22377E0>
               └ <fastapi.routing.APIRouter object at 0x0000025CE213B360>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x0000025CE213D600>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000025CE21EB230>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 14, in lifespan
    model_service.load_models()
    │             └ <function ModelService.load_models at 0x0000025CE1FBC360>
    └ <services.model_service.ModelService object at 0x0000025CE21EEFD0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\model_service.py", line 28, in load_models
    with open(settings.LABEL_ENCODER_FINALGRADE_PATH, 'rb') as f:
              │        │                                       └ <_io.BufferedReader name='D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\src\\assets\\models\\label_encoder_dropoutv2.pkl'>
              │        └ WindowsPath('D:/Kuliah/Semt 7/Capstone/capstone-backend/src/assets/models/label_encoder_finalgradev2.pkl')
              └ <module 'config.settings' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\src\\config\\settings.py'>

FileNotFoundError: [Errno 2] No such file or directory: 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\src\\assets\\models\\label_encoder_finalgradev2.pkl'
2025-12-10 18:07:12 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:07:12 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:07:13 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:08:10 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:08:11 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:08:11 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:08:13 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:08:21 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:08:22 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:08:22 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:08:24 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:08:25 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:08:25 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:08:26 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:08:39 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:08:40 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:08:40 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:08:41 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:09:16 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:09:17 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:09:17 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:09:19 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:09:38 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:09:39 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:09:39 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:09:41 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:10:07 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:10:08 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:10:08 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:10:09 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:10:10 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:10:10 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:10:13 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:10:27 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:10:28 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:10:28 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:10:29 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:11:06 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:11:07 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:11:07 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:11:09 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:11:10 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:11:10 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:11:12 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:11:18 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:11:19 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:11:19 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:11:21 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:11:22 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:11:23 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:11:23 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:11:25 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:12:01 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:12:02 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:12:02 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:12:04 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:12:05 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:12:06 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:12:06 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:12:08 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:12:20 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:24:08 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:24:08 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:24:10 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:24:14 | ERROR    | services.encoder_service:encode_finalgrade:19 - Final grade label encoder is not loaded
NoneType: None
2025-12-10 18:24:47 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:27:13 | ERROR    | services.encoder_service:encode_finalgrade:19 - Final grade label encoder is not loaded
NoneType: None
2025-12-10 18:27:35 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:27:35 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:27:37 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:32:19 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:32:20 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:32:20 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:32:22 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:32:23 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:32:24 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:32:24 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:32:26 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:32:26 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:32:27 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:32:27 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:32:29 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:32:58 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:32:59 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:32:59 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:33:01 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:34:34 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:34:35 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:34:35 | INFO     | app:lifespan:13 - loading models...
2025-12-10 18:34:37 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:36:23 | INFO     | app:lifespan:18 - Shutting down the application...
2025-12-10 18:36:24 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:36:24 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:36:26 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:36:26 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:36:26 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:36:58 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:36:59 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:36:59 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:37:00 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:37:00 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:37:00 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:37:10 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:37:11 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:37:11 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:37:13 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:37:13 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:37:13 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:37:20 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:37:21 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:37:21 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:37:23 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:37:23 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:37:23 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:39:33 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:39:34 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:39:34 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:39:36 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:39:36 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:39:36 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:39:38 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:39:38 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:39:40 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:39:40 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:39:40 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:41:13 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:41:14 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:41:14 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:41:15 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:41:15 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:41:15 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:42:44 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:42:45 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:42:45 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:42:47 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:42:47 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:42:47 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:42:49 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:42:52 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:42:52 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:42:53 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:42:53 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:42:53 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:42:56 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:42:56 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:42:58 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:42:58 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:42:58 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:43:00 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:43:01 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:43:01 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:43:03 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:43:03 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:43:03 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:43:04 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:43:04 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:43:06 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:43:06 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:43:06 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:43:07 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:43:07 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:43:09 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:43:09 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:43:09 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:43:31 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:43:32 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:43:32 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:43:34 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:43:34 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:43:34 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:45:50 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:45:51 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:45:51 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:45:53 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:45:53 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:45:53 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:47:33 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:47:34 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:47:34 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:47:36 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:47:36 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:47:39 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:47:39 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:47:41 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:47:41 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:47:42 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:47:42 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:47:44 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:47:44 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:47:46 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:47:46 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:47:48 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:47:48 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:47:48 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:49:59 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:50:05 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:50:05 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:50:07 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:50:07 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:50:07 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:50:08 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:50:08 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:50:10 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:50:10 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:50:10 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:51:11 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:51:43 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:51:43 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:51:45 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:51:45 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:51:45 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:51:49 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:51:52 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:51:52 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:51:53 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:51:53 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:51:53 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:51:54 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:51:54 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:51:56 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:51:56 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:51:56 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:52:56 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:52:57 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:52:57 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:52:59 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:52:59 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:52:59 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:53:00 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:53:01 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:53:01 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:53:03 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:53:03 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:53:03 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:53:07 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:53:08 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:53:08 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:53:09 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:53:09 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:53:09 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:53:12 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:53:13 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:53:13 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:53:14 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:53:14 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:53:14 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:56:44 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:56:45 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:56:45 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:56:48 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:56:48 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:56:48 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:56:49 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:56:49 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:56:51 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:56:51 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:56:51 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-10 18:58:14 | INFO     | app:lifespan:28 - Shutting down the application...
2025-12-10 18:58:15 | INFO     | app:lifespan:12 - Starting up the application...
2025-12-10 18:58:15 | INFO     | app:lifespan:13 - Loading models...
2025-12-10 18:58:17 | SUCCESS  | app:lifespan:15 - Models loaded successfully.
2025-12-10 18:58:17 | INFO     | app:lifespan:18 - Initializing services...
2025-12-10 18:58:17 | SUCCESS  | app:lifespan:23 - Services initialized successfully.
2025-12-11 11:12:07 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:12:26 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:12:27 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:12:27 | INFO     | app:lifespan:16 - Starting up the application...
2025-12-11 11:12:27 | INFO     | app:lifespan:19 - Testing database connection...
2025-12-11 11:12:31 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x0000027AB74E5440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x0000027AB75409A0>
                                      └ <function spawn_main at 0x0000027AB75409A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 344
               │     └ 3
               └ <function _main at 0x0000027AB7540A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 344
           │    └ <function BaseProcess._bootstrap at 0x0000027AB71F82C0>
           └ <SpawnProcess name='SpawnProcess-1' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000027AB71F37E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000027ABA9B1550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27408 started>
    │    └ <function subprocess_started at 0x0000027ABA9D37E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=588, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000027ABA9B16A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x0000027ABA99ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x0000027ABA9B1550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x0000027ABA9B16A0>
           │           │    │             └ [<socket.socket fd=588, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x0000027ABA9D2980>
           │           └ <uvicorn.server.Server object at 0x0000027ABA9B16A0>
           └ <function run at 0x0000027AB7C8CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000027AB705BA00>
           │      └ <function Runner.run at 0x0000027AB9600FE0>
           └ <asyncio.runners.Runner object at 0x0000027ABA9B2120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000027AB95FEA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000027ABA9B2120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000027AB95FE980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000027AB96007C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000027AB7DB2020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027ABA916830>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027ABA916830>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027ABA916830>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027ABA916830>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x0000027ABAA9B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>
          │   │      │    └ <function LifespanOn.receive at 0x0000027ABAA9B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027ABA9B3230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x0000027ABAA15D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027ABA9B3230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027ABAAB82F0>
          └ <fastapi.applications.FastAPI object at 0x0000027ABAA15D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027ABAAB81A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027ABAAB82F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000027ABAAB8050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027ABAAB81A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x0000027ABA9C2210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000027ABAAB8050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000027ABA9C2210>>
          └ <fastapi.routing.APIRouter object at 0x0000027ABA9C2210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x0000027ABA64DBC0>
          └ <fastapi.routing.APIRouter object at 0x0000027ABA9C2210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x0000027ABAA15D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000027ABAAA9800>
               └ <fastapi.routing.APIRouter object at 0x0000027ABA9C2210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000027ABA947DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000027ABAAB8440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000027ABAA15D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000027ABAAA8680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000027ABA947AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000027ABAA17890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000027ABAA15D10>
               └ <function lifespan at 0x0000027ABAA9B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x0000027ABA9DE4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000027ABAA179D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x0000027ABA822520>
       └ <core.database.DatabaseConnection object at 0x0000027ABA7A63C0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x0000027ABA8222A0>
         └ <core.database.DatabaseConnection object at 0x0000027ABA7A63C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x0000027ABAAA2DC0>
                └ <contextlib._GeneratorContextManager object at 0x0000027ABAA1EAC0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000027ABA7A63C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x0000027ABA820CC0>
    └ <pymysql.connections.Connection object at 0x0000027ABAAB8590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:12:31 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x0000027AB74E5440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x0000027AB75409A0>
                                      └ <function spawn_main at 0x0000027AB75409A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 344
               │     └ 3
               └ <function _main at 0x0000027AB7540A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 344
           │    └ <function BaseProcess._bootstrap at 0x0000027AB71F82C0>
           └ <SpawnProcess name='SpawnProcess-1' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000027AB71F37E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000027ABA9B1550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=27408 started>
    │    └ <function subprocess_started at 0x0000027ABA9D37E0>
    └ <SpawnProcess name='SpawnProcess-1' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=588, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000027ABA9B16A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x0000027ABA99ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x0000027ABA9B1550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x0000027ABA9B16A0>
           │           │    │             └ [<socket.socket fd=588, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x0000027ABA9D2980>
           │           └ <uvicorn.server.Server object at 0x0000027ABA9B16A0>
           └ <function run at 0x0000027AB7C8CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000027AB705BA00>
           │      └ <function Runner.run at 0x0000027AB9600FE0>
           └ <asyncio.runners.Runner object at 0x0000027ABA9B2120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000027AB95FEA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000027ABA9B2120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000027AB95FE980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000027AB96007C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000027AB7DB2020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027ABA916830>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027ABA916830>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027ABA916830>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027ABA916830>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x0000027ABAA9B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>
          │   │      │    └ <function LifespanOn.receive at 0x0000027ABAA9B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027ABA9B3230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x0000027ABAA15D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027ABA9B3230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027ABAAB82F0>
          └ <fastapi.applications.FastAPI object at 0x0000027ABAA15D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027ABAAB81A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027ABAAB82F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000027ABAAB8050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027ABAAB81A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x0000027ABA9C2210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000027ABAAB8050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000027ABA9C2210>>
          └ <fastapi.routing.APIRouter object at 0x0000027ABA9C2210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000027ABA9B3A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x0000027ABA64DBC0>
          └ <fastapi.routing.APIRouter object at 0x0000027ABA9C2210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x0000027ABAA15D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000027ABAAA9800>
               └ <fastapi.routing.APIRouter object at 0x0000027ABA9C2210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000027ABA947DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000027ABAAB8440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000027ABAA15D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000027ABAAA8680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000027ABA947AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000027ABAA17890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000027ABAA15D10>
               └ <function lifespan at 0x0000027ABAA9B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x0000027ABA9DE4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000027ABAA179D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x0000027ABA822520>
       └ <core.database.DatabaseConnection object at 0x0000027ABA7A63C0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x0000027ABA8222A0>
         └ <core.database.DatabaseConnection object at 0x0000027ABA7A63C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x0000027ABAAA2DC0>
                └ <contextlib._GeneratorContextManager object at 0x0000027ABAA1EAC0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000027ABA7A63C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x0000027ABA820CC0>
    └ <pymysql.connections.Connection object at 0x0000027ABAAB8590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:12:31 | ERROR    | app:lifespan:23 - Database connection failed
2025-12-11 11:12:31 | INFO     | app:lifespan:25 - Loading models...
2025-12-11 11:12:32 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:12:42 | SUCCESS  | app:lifespan:27 - Models loaded successfully.
2025-12-11 11:12:42 | INFO     | app:lifespan:30 - Initializing services...
2025-12-11 11:12:42 | SUCCESS  | app:lifespan:36 - Services initialized successfully.
2025-12-11 11:13:30 | INFO     | app:lifespan:41 - Shutting down the application...
2025-12-11 11:13:31 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:13:31 | INFO     | app:lifespan:16 - Starting up the application...
2025-12-11 11:13:31 | INFO     | app:lifespan:19 - Testing database connection...
2025-12-11 11:13:35 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x000001CDAF175440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x000001CDAF1D09A0>
                                      └ <function spawn_main at 0x000001CDAF1D09A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 328
               │     └ 3
               └ <function _main at 0x000001CDAF1D0A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 328
           │    └ <function BaseProcess._bootstrap at 0x000001CDAEE782C0>
           └ <SpawnProcess name='SpawnProcess-2' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001CDAEE737E0>
    └ <SpawnProcess name='SpawnProcess-2' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001CDB2641550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=27408 started>
    │    └ <function subprocess_started at 0x000001CDB26637E0>
    └ <SpawnProcess name='SpawnProcess-2' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=436, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001CDB26416A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x000001CDB262ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x000001CDB2641550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x000001CDB26416A0>
           │           │    │             └ [<socket.socket fd=436, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x000001CDB2662980>
           │           └ <uvicorn.server.Server object at 0x000001CDB26416A0>
           └ <function run at 0x000001CDAF91CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001CDAECDBA00>
           │      └ <function Runner.run at 0x000001CDB128CFE0>
           └ <asyncio.runners.Runner object at 0x000001CDB2642120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001CDB128AA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001CDB2642120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001CDB128A980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001CDB128C7C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001CDAFA42020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001CDB1293880>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001CDB1293880>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001CDB1293880>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001CDB1293880>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x000001CDB272B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>
          │   │      │    └ <function LifespanOn.receive at 0x000001CDB272B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001CDB2643230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x000001CDB26A5D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001CDB2643230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001CDB27482F0>
          └ <fastapi.applications.FastAPI object at 0x000001CDB26A5D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001CDB27481A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001CDB27482F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001CDB2748050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001CDB27481A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x000001CDB2652210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001CDB2748050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001CDB2652210>>
          └ <fastapi.routing.APIRouter object at 0x000001CDB2652210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x000001CDB22BDBC0>
          └ <fastapi.routing.APIRouter object at 0x000001CDB2652210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x000001CDB26A5D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001CDB2739800>
               └ <fastapi.routing.APIRouter object at 0x000001CDB2652210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001CDB25C7DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001CDB2748440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001CDB26A5D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001CDB2738680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001CDB25C7AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001CDB26A7890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001CDB26A5D10>
               └ <function lifespan at 0x000001CDB272B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x000001CDB266E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001CDB26A79D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x000001CDB2492520>
       └ <core.database.DatabaseConnection object at 0x000001CDB24163C0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x000001CDB24922A0>
         └ <core.database.DatabaseConnection object at 0x000001CDB24163C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000001CDB2732DC0>
                └ <contextlib._GeneratorContextManager object at 0x000001CDB26AEAC0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x000001CDB24163C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x000001CDB2490CC0>
    └ <pymysql.connections.Connection object at 0x000001CDB2748590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:13:35 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x000001CDAF175440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x000001CDAF1D09A0>
                                      └ <function spawn_main at 0x000001CDAF1D09A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 328
               │     └ 3
               └ <function _main at 0x000001CDAF1D0A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 328
           │    └ <function BaseProcess._bootstrap at 0x000001CDAEE782C0>
           └ <SpawnProcess name='SpawnProcess-2' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001CDAEE737E0>
    └ <SpawnProcess name='SpawnProcess-2' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001CDB2641550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-2' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-2' parent=27408 started>
    │    └ <function subprocess_started at 0x000001CDB26637E0>
    └ <SpawnProcess name='SpawnProcess-2' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=436, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001CDB26416A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x000001CDB262ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x000001CDB2641550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x000001CDB26416A0>
           │           │    │             └ [<socket.socket fd=436, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x000001CDB2662980>
           │           └ <uvicorn.server.Server object at 0x000001CDB26416A0>
           └ <function run at 0x000001CDAF91CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001CDAECDBA00>
           │      └ <function Runner.run at 0x000001CDB128CFE0>
           └ <asyncio.runners.Runner object at 0x000001CDB2642120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001CDB128AA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001CDB2642120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001CDB128A980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001CDB128C7C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001CDAFA42020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001CDB1293880>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001CDB1293880>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001CDB1293880>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001CDB1293880>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x000001CDB272B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>
          │   │      │    └ <function LifespanOn.receive at 0x000001CDB272B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001CDB2643230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x000001CDB26A5D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001CDB2643230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001CDB27482F0>
          └ <fastapi.applications.FastAPI object at 0x000001CDB26A5D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001CDB27481A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001CDB27482F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001CDB2748050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001CDB27481A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x000001CDB2652210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001CDB2748050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001CDB2652210>>
          └ <fastapi.routing.APIRouter object at 0x000001CDB2652210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001CDB2643A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x000001CDB22BDBC0>
          └ <fastapi.routing.APIRouter object at 0x000001CDB2652210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x000001CDB26A5D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001CDB2739800>
               └ <fastapi.routing.APIRouter object at 0x000001CDB2652210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001CDB25C7DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001CDB2748440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001CDB26A5D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001CDB2738680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001CDB25C7AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001CDB26A7890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001CDB26A5D10>
               └ <function lifespan at 0x000001CDB272B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x000001CDB266E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001CDB26A79D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x000001CDB2492520>
       └ <core.database.DatabaseConnection object at 0x000001CDB24163C0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x000001CDB24922A0>
         └ <core.database.DatabaseConnection object at 0x000001CDB24163C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000001CDB2732DC0>
                └ <contextlib._GeneratorContextManager object at 0x000001CDB26AEAC0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x000001CDB24163C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x000001CDB2490CC0>
    └ <pymysql.connections.Connection object at 0x000001CDB2748590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:13:35 | ERROR    | app:lifespan:23 - Database connection failed
2025-12-11 11:13:35 | INFO     | app:lifespan:25 - Loading models...
2025-12-11 11:13:37 | SUCCESS  | app:lifespan:27 - Models loaded successfully.
2025-12-11 11:13:37 | INFO     | app:lifespan:30 - Initializing services...
2025-12-11 11:13:37 | SUCCESS  | app:lifespan:36 - Services initialized successfully.
2025-12-11 11:13:51 | INFO     | app:lifespan:41 - Shutting down the application...
2025-12-11 11:13:52 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:13:52 | INFO     | app:lifespan:16 - Starting up the application...
2025-12-11 11:13:52 | INFO     | app:lifespan:19 - Testing database connection...
2025-12-11 11:13:56 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000292E8535440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x00000292E85909A0>
                                      └ <function spawn_main at 0x00000292E85909A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 344
               │     └ 3
               └ <function _main at 0x00000292E8590A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 344
           │    └ <function BaseProcess._bootstrap at 0x00000292E82482C0>
           └ <SpawnProcess name='SpawnProcess-3' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000292E82437E0>
    └ <SpawnProcess name='SpawnProcess-3' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000292EB9F1550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-3' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-3' parent=27408 started>
    │    └ <function subprocess_started at 0x00000292EBA137E0>
    └ <SpawnProcess name='SpawnProcess-3' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=384, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000292EB9F16A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x00000292EB9DADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x00000292EB9F1550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x00000292EB9F16A0>
           │           │    │             └ [<socket.socket fd=384, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x00000292EBA12980>
           │           └ <uvicorn.server.Server object at 0x00000292EB9F16A0>
           └ <function run at 0x00000292E8CCCEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000292E80ABA00>
           │      └ <function Runner.run at 0x00000292EA640FE0>
           └ <asyncio.runners.Runner object at 0x00000292EB9F2120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000292EA63EA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000292EB9F2120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000292EA63E980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000292EA6407C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000292E8DF2020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000292EA63B880>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000292EA63B880>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000292EA63B880>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000292EA63B880>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x00000292EBADB560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>
          │   │      │    └ <function LifespanOn.receive at 0x00000292EBADB600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000292EB9F3230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x00000292EBA55D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000292EB9F3230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000292EBAF82F0>
          └ <fastapi.applications.FastAPI object at 0x00000292EBA55D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000292EBAF81A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000292EBAF82F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x00000292EBAF8050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000292EBAF81A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x00000292EBA02210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x00000292EBAF8050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000292EBA02210>>
          └ <fastapi.routing.APIRouter object at 0x00000292EBA02210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x00000292EB66DBC0>
          └ <fastapi.routing.APIRouter object at 0x00000292EBA02210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x00000292EBA55D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000292EBAE9800>
               └ <fastapi.routing.APIRouter object at 0x00000292EBA02210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000292EB977DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000292EBAF8440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x00000292EBA55D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000292EBAE8680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000292EB977AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000292EBA57890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x00000292EBA55D10>
               └ <function lifespan at 0x00000292EBADB740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x00000292EBA1E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000292EBA579D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x00000292EB842520>
       └ <core.database.DatabaseConnection object at 0x00000292EB7C63C0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000292EB8422A0>
         └ <core.database.DatabaseConnection object at 0x00000292EB7C63C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x00000292EBAE2DC0>
                └ <contextlib._GeneratorContextManager object at 0x00000292EBA5EAC0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x00000292EB7C63C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000292EB840CC0>
    └ <pymysql.connections.Connection object at 0x00000292EBAF8590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:13:56 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000292E8535440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x00000292E85909A0>
                                      └ <function spawn_main at 0x00000292E85909A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 344
               │     └ 3
               └ <function _main at 0x00000292E8590A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 344
           │    └ <function BaseProcess._bootstrap at 0x00000292E82482C0>
           └ <SpawnProcess name='SpawnProcess-3' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000292E82437E0>
    └ <SpawnProcess name='SpawnProcess-3' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000292EB9F1550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-3' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-3' parent=27408 started>
    │    └ <function subprocess_started at 0x00000292EBA137E0>
    └ <SpawnProcess name='SpawnProcess-3' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=384, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000292EB9F16A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x00000292EB9DADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x00000292EB9F1550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x00000292EB9F16A0>
           │           │    │             └ [<socket.socket fd=384, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x00000292EBA12980>
           │           └ <uvicorn.server.Server object at 0x00000292EB9F16A0>
           └ <function run at 0x00000292E8CCCEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000292E80ABA00>
           │      └ <function Runner.run at 0x00000292EA640FE0>
           └ <asyncio.runners.Runner object at 0x00000292EB9F2120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000292EA63EA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000292EB9F2120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000292EA63E980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000292EA6407C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000292E8DF2020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000292EA63B880>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000292EA63B880>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000292EA63B880>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000292EA63B880>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x00000292EBADB560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>
          │   │      │    └ <function LifespanOn.receive at 0x00000292EBADB600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000292EB9F3230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x00000292EBA55D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000292EB9F3230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000292EBAF82F0>
          └ <fastapi.applications.FastAPI object at 0x00000292EBA55D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000292EBAF81A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000292EBAF82F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x00000292EBAF8050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000292EBAF81A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x00000292EBA02210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x00000292EBAF8050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000292EBA02210>>
          └ <fastapi.routing.APIRouter object at 0x00000292EBA02210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x00000292EB9F3A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x00000292EB66DBC0>
          └ <fastapi.routing.APIRouter object at 0x00000292EBA02210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x00000292EBA55D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000292EBAE9800>
               └ <fastapi.routing.APIRouter object at 0x00000292EBA02210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000292EB977DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000292EBAF8440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x00000292EBA55D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000292EBAE8680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000292EB977AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000292EBA57890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x00000292EBA55D10>
               └ <function lifespan at 0x00000292EBADB740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x00000292EBA1E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000292EBA579D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x00000292EB842520>
       └ <core.database.DatabaseConnection object at 0x00000292EB7C63C0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000292EB8422A0>
         └ <core.database.DatabaseConnection object at 0x00000292EB7C63C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x00000292EBAE2DC0>
                └ <contextlib._GeneratorContextManager object at 0x00000292EBA5EAC0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x00000292EB7C63C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000292EB840CC0>
    └ <pymysql.connections.Connection object at 0x00000292EBAF8590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:13:56 | ERROR    | app:lifespan:23 - Database connection failed
2025-12-11 11:13:56 | INFO     | app:lifespan:25 - Loading models...
2025-12-11 11:13:57 | SUCCESS  | app:lifespan:27 - Models loaded successfully.
2025-12-11 11:13:57 | INFO     | app:lifespan:30 - Initializing services...
2025-12-11 11:13:57 | SUCCESS  | app:lifespan:36 - Services initialized successfully.
2025-12-11 11:14:38 | INFO     | app:lifespan:41 - Shutting down the application...
2025-12-11 11:14:39 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:14:39 | INFO     | app:lifespan:16 - Starting up the application...
2025-12-11 11:14:39 | INFO     | app:lifespan:19 - Testing database connection...
2025-12-11 11:14:43 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x000001EA98415440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x000001EA984709A0>
                                      └ <function spawn_main at 0x000001EA984709A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 336
               │     └ 3
               └ <function _main at 0x000001EA98470A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 336
           │    └ <function BaseProcess._bootstrap at 0x000001EA981282C0>
           └ <SpawnProcess name='SpawnProcess-4' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001EA981237E0>
    └ <SpawnProcess name='SpawnProcess-4' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001EA9B891550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-4' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-4' parent=27408 started>
    │    └ <function subprocess_started at 0x000001EA9B8B37E0>
    └ <SpawnProcess name='SpawnProcess-4' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=348, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001EA9B8916A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x000001EA9B87ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x000001EA9B891550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x000001EA9B8916A0>
           │           │    │             └ [<socket.socket fd=348, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x000001EA9B8B2980>
           │           └ <uvicorn.server.Server object at 0x000001EA9B8916A0>
           └ <function run at 0x000001EA98B9CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001EA97F8BA00>
           │      └ <function Runner.run at 0x000001EA9A4CCFE0>
           └ <asyncio.runners.Runner object at 0x000001EA9B892120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001EA9A4CAA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001EA9B892120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001EA9A4CA980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001EA9A4CC7C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001EA98CB2020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA9B7A27A0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA9B7A27A0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA9B7A27A0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA9B7A27A0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x000001EA9B94B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>
          │   │      │    └ <function LifespanOn.receive at 0x000001EA9B94B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001EA9B893230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x000001EA9B8F5D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001EA9B893230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EA9B9682F0>
          └ <fastapi.applications.FastAPI object at 0x000001EA9B8F5D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EA9B9681A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EA9B9682F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001EA9B968050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EA9B9681A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x000001EA9B8A2210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001EA9B968050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001EA9B8A2210>>
          └ <fastapi.routing.APIRouter object at 0x000001EA9B8A2210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x000001EA9B52DBC0>
          └ <fastapi.routing.APIRouter object at 0x000001EA9B8A2210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x000001EA9B8F5D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA9B959800>
               └ <fastapi.routing.APIRouter object at 0x000001EA9B8A2210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA9B827DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA9B968440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001EA9B8F5D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA9B958680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA9B827AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA9B8F7890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001EA9B8F5D10>
               └ <function lifespan at 0x000001EA9B94B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x000001EA9B8BE4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA9B8F79D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x000001EA9B702520>
       └ <core.database.DatabaseConnection object at 0x000001EA9B6863C0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x000001EA9B7022A0>
         └ <core.database.DatabaseConnection object at 0x000001EA9B6863C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000001EA9B952DC0>
                └ <contextlib._GeneratorContextManager object at 0x000001EA9B8FEAC0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x000001EA9B6863C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x000001EA9B700CC0>
    └ <pymysql.connections.Connection object at 0x000001EA9B968590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:14:43 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x000001EA98415440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x000001EA984709A0>
                                      └ <function spawn_main at 0x000001EA984709A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 336
               │     └ 3
               └ <function _main at 0x000001EA98470A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 336
           │    └ <function BaseProcess._bootstrap at 0x000001EA981282C0>
           └ <SpawnProcess name='SpawnProcess-4' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001EA981237E0>
    └ <SpawnProcess name='SpawnProcess-4' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001EA9B891550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-4' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-4' parent=27408 started>
    │    └ <function subprocess_started at 0x000001EA9B8B37E0>
    └ <SpawnProcess name='SpawnProcess-4' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=348, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001EA9B8916A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x000001EA9B87ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x000001EA9B891550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x000001EA9B8916A0>
           │           │    │             └ [<socket.socket fd=348, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x000001EA9B8B2980>
           │           └ <uvicorn.server.Server object at 0x000001EA9B8916A0>
           └ <function run at 0x000001EA98B9CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001EA97F8BA00>
           │      └ <function Runner.run at 0x000001EA9A4CCFE0>
           └ <asyncio.runners.Runner object at 0x000001EA9B892120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001EA9A4CAA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001EA9B892120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001EA9A4CA980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001EA9A4CC7C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001EA98CB2020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA9B7A27A0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA9B7A27A0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA9B7A27A0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA9B7A27A0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x000001EA9B94B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>
          │   │      │    └ <function LifespanOn.receive at 0x000001EA9B94B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001EA9B893230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x000001EA9B8F5D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001EA9B893230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EA9B9682F0>
          └ <fastapi.applications.FastAPI object at 0x000001EA9B8F5D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EA9B9681A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EA9B9682F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001EA9B968050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EA9B9681A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x000001EA9B8A2210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001EA9B968050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001EA9B8A2210>>
          └ <fastapi.routing.APIRouter object at 0x000001EA9B8A2210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA9B893A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x000001EA9B52DBC0>
          └ <fastapi.routing.APIRouter object at 0x000001EA9B8A2210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x000001EA9B8F5D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA9B959800>
               └ <fastapi.routing.APIRouter object at 0x000001EA9B8A2210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA9B827DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA9B968440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001EA9B8F5D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA9B958680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA9B827AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA9B8F7890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001EA9B8F5D10>
               └ <function lifespan at 0x000001EA9B94B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x000001EA9B8BE4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA9B8F79D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x000001EA9B702520>
       └ <core.database.DatabaseConnection object at 0x000001EA9B6863C0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x000001EA9B7022A0>
         └ <core.database.DatabaseConnection object at 0x000001EA9B6863C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000001EA9B952DC0>
                └ <contextlib._GeneratorContextManager object at 0x000001EA9B8FEAC0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x000001EA9B6863C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x000001EA9B700CC0>
    └ <pymysql.connections.Connection object at 0x000001EA9B968590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:14:43 | ERROR    | app:lifespan:23 - Database connection failed
2025-12-11 11:14:43 | INFO     | app:lifespan:25 - Loading models...
2025-12-11 11:14:45 | SUCCESS  | app:lifespan:27 - Models loaded successfully.
2025-12-11 11:14:45 | INFO     | app:lifespan:30 - Initializing services...
2025-12-11 11:14:45 | SUCCESS  | app:lifespan:36 - Services initialized successfully.
2025-12-11 11:14:46 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:14:46 | INFO     | app:lifespan:16 - Starting up the application...
2025-12-11 11:14:46 | INFO     | app:lifespan:19 - Testing database connection...
2025-12-11 11:14:50 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x000001EA87E75440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x000001EA87ED49A0>
                                      └ <function spawn_main at 0x000001EA87ED49A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 300
               │     └ 3
               └ <function _main at 0x000001EA87ED4A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 300
           │    └ <function BaseProcess._bootstrap at 0x000001EA87B582C0>
           └ <SpawnProcess name='SpawnProcess-5' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001EA87B537E0>
    └ <SpawnProcess name='SpawnProcess-5' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001EA8B341550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-5' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-5' parent=27408 started>
    │    └ <function subprocess_started at 0x000001EA8B3637E0>
    └ <SpawnProcess name='SpawnProcess-5' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=576, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001EA8B3416A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x000001EA8B32ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x000001EA8B341550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x000001EA8B3416A0>
           │           │    │             └ [<socket.socket fd=576, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x000001EA8B362980>
           │           └ <uvicorn.server.Server object at 0x000001EA8B3416A0>
           └ <function run at 0x000001EA8861CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001EA879BBA00>
           │      └ <function Runner.run at 0x000001EA89FC0FE0>
           └ <asyncio.runners.Runner object at 0x000001EA8B342120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001EA89FBEA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001EA8B342120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001EA89FBE980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001EA89FC07C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001EA88742020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA8B1114B0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA8B1114B0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA8B1114B0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA8B1114B0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x000001EA8B42B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>
          │   │      │    └ <function LifespanOn.receive at 0x000001EA8B42B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001EA8B343230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x000001EA8B3A5D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001EA8B343230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EA8B4482F0>
          └ <fastapi.applications.FastAPI object at 0x000001EA8B3A5D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EA8B4481A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EA8B4482F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001EA8B448050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EA8B4481A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x000001EA8B352210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001EA8B448050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001EA8B352210>>
          └ <fastapi.routing.APIRouter object at 0x000001EA8B352210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x000001EA8AFBDBC0>
          └ <fastapi.routing.APIRouter object at 0x000001EA8B352210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x000001EA8B3A5D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA8B439800>
               └ <fastapi.routing.APIRouter object at 0x000001EA8B352210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA8B2C7DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA8B448440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001EA8B3A5D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA8B438680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA8B2C7AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA8B3A7890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001EA8B3A5D10>
               └ <function lifespan at 0x000001EA8B42B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x000001EA8B36E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA8B3A79D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x000001EA8B192520>
       └ <core.database.DatabaseConnection object at 0x000001EA8B1163C0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x000001EA8B1922A0>
         └ <core.database.DatabaseConnection object at 0x000001EA8B1163C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000001EA8B432DC0>
                └ <contextlib._GeneratorContextManager object at 0x000001EA8B3AEAC0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x000001EA8B1163C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x000001EA8B190CC0>
    └ <pymysql.connections.Connection object at 0x000001EA8B448590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:14:50 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x000001EA87E75440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x000001EA87ED49A0>
                                      └ <function spawn_main at 0x000001EA87ED49A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 300
               │     └ 3
               └ <function _main at 0x000001EA87ED4A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 300
           │    └ <function BaseProcess._bootstrap at 0x000001EA87B582C0>
           └ <SpawnProcess name='SpawnProcess-5' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001EA87B537E0>
    └ <SpawnProcess name='SpawnProcess-5' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001EA8B341550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-5' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-5' parent=27408 started>
    │    └ <function subprocess_started at 0x000001EA8B3637E0>
    └ <SpawnProcess name='SpawnProcess-5' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=576, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001EA8B3416A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x000001EA8B32ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x000001EA8B341550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x000001EA8B3416A0>
           │           │    │             └ [<socket.socket fd=576, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x000001EA8B362980>
           │           └ <uvicorn.server.Server object at 0x000001EA8B3416A0>
           └ <function run at 0x000001EA8861CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001EA879BBA00>
           │      └ <function Runner.run at 0x000001EA89FC0FE0>
           └ <asyncio.runners.Runner object at 0x000001EA8B342120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001EA89FBEA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001EA8B342120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001EA89FBE980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001EA89FC07C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001EA88742020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA8B1114B0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA8B1114B0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA8B1114B0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001EA8B1114B0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x000001EA8B42B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>
          │   │      │    └ <function LifespanOn.receive at 0x000001EA8B42B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001EA8B343230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x000001EA8B3A5D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001EA8B343230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EA8B4482F0>
          └ <fastapi.applications.FastAPI object at 0x000001EA8B3A5D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EA8B4481A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EA8B4482F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001EA8B448050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EA8B4481A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x000001EA8B352210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001EA8B448050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001EA8B352210>>
          └ <fastapi.routing.APIRouter object at 0x000001EA8B352210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x000001EA8B343A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x000001EA8AFBDBC0>
          └ <fastapi.routing.APIRouter object at 0x000001EA8B352210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x000001EA8B3A5D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA8B439800>
               └ <fastapi.routing.APIRouter object at 0x000001EA8B352210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA8B2C7DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA8B448440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001EA8B3A5D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA8B438680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x000001EA8B2C7AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA8B3A7890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x000001EA8B3A5D10>
               └ <function lifespan at 0x000001EA8B42B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x000001EA8B36E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000001EA8B3A79D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x000001EA8B192520>
       └ <core.database.DatabaseConnection object at 0x000001EA8B1163C0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x000001EA8B1922A0>
         └ <core.database.DatabaseConnection object at 0x000001EA8B1163C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000001EA8B432DC0>
                └ <contextlib._GeneratorContextManager object at 0x000001EA8B3AEAC0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x000001EA8B1163C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x000001EA8B190CC0>
    └ <pymysql.connections.Connection object at 0x000001EA8B448590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:14:50 | ERROR    | app:lifespan:23 - Database connection failed
2025-12-11 11:14:50 | INFO     | app:lifespan:25 - Loading models...
2025-12-11 11:14:52 | SUCCESS  | app:lifespan:27 - Models loaded successfully.
2025-12-11 11:14:52 | INFO     | app:lifespan:30 - Initializing services...
2025-12-11 11:14:52 | SUCCESS  | app:lifespan:36 - Services initialized successfully.
2025-12-11 11:15:00 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:15:04 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x0000018D5C095BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000018D5B5AD4E0>
    └ <Thread(asyncio-portal-18d60177610, started daemon 27724)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000018D5B5AD260>
    └ <Thread(asyncio-portal-18d60177610, started daemon 27724)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-18d60177610, started daemon 27724)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-18d60177610, started daemon 27724)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000018D601F18A0>
    └ <Thread(asyncio-portal-18d60177610, started daemon 27724)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000018D5C03C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D601F1940>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x0000018D5E430CC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D601F1BC0>
           │      └ <function Runner.run at 0x0000018D5E3B8860>
           └ <asyncio.runners.Runner object at 0x0000018D60176D50>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018D5E3B22A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000018D60176D50>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000018D5E3B2200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000018D5E3B8040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000018D5E329760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FCFD0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FCFD0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FCFD0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FCFD0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x0000018D6014D120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D601F1800>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D601F1800>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
          └ <fastapi.applications.FastAPI object at 0x0000018D5FEC3620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D601F22A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D601F22A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018D60177750>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018D601816E0>>
          └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │     └ <function Route.handle at 0x0000018D5EC068E0>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <function request_response.<locals>.app at 0x0000018D601C3A60>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    └ <starlette.requests.Request object at 0x0000018D60183BB0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018D601F2480>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F2520>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018D601F2480>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018D60183BB0>
                     └ <function get_request_handler.<locals>.app at 0x0000018D601C39C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018D5EC2C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {}
                 │         └ <function health at 0x0000018D601C3880>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 63, in health
    "database_connected": db.test_connection(),
                          │  └ <function DatabaseConnection.test_connection at 0x0000018D60155940>
                          └ <core.database.DatabaseConnection object at 0x0000018D5FEC2510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x0000018D601556C0>
         └ <core.database.DatabaseConnection object at 0x0000018D5FEC2510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x0000018D6021C820>
                └ <contextlib._GeneratorContextManager object at 0x0000018D60201160>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000018D5FEC2510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x0000018D601540E0>
    └ <pymysql.connections.Connection object at 0x0000018D601EC980>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:15:04 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x0000018D5C095BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000018D5B5AD4E0>
    └ <Thread(asyncio-portal-18d60177610, started daemon 27724)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000018D5B5AD260>
    └ <Thread(asyncio-portal-18d60177610, started daemon 27724)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-18d60177610, started daemon 27724)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-18d60177610, started daemon 27724)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000018D601F18A0>
    └ <Thread(asyncio-portal-18d60177610, started daemon 27724)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000018D5C03C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D601F1940>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x0000018D5E430CC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D601F1BC0>
           │      └ <function Runner.run at 0x0000018D5E3B8860>
           └ <asyncio.runners.Runner object at 0x0000018D60176D50>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018D5E3B22A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000018D60176D50>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000018D5E3B2200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000018D5E3B8040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000018D5E329760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FCFD0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FCFD0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FCFD0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FCFD0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x0000018D6014D120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D601F1800>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D601F1800>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
          └ <fastapi.applications.FastAPI object at 0x0000018D5FEC3620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D601F22A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D601F22A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018D60177750>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018D601816E0>>
          └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │     └ <function Route.handle at 0x0000018D5EC068E0>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <function request_response.<locals>.app at 0x0000018D601C3A60>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F23E0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    └ <starlette.requests.Request object at 0x0000018D60183BB0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018D601F2480>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F2520>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F16C0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018D601F2480>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018D60183BB0>
                     └ <function get_request_handler.<locals>.app at 0x0000018D601C39C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018D5EC2C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {}
                 │         └ <function health at 0x0000018D601C3880>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 63, in health
    "database_connected": db.test_connection(),
                          │  └ <function DatabaseConnection.test_connection at 0x0000018D60155940>
                          └ <core.database.DatabaseConnection object at 0x0000018D5FEC2510>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x0000018D601556C0>
         └ <core.database.DatabaseConnection object at 0x0000018D5FEC2510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x0000018D6021C820>
                └ <contextlib._GeneratorContextManager object at 0x0000018D60201160>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000018D5FEC2510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x0000018D601540E0>
    └ <pymysql.connections.Connection object at 0x0000018D601EC980>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:15:05 | ERROR    | api.router:predict_final_result:46 - Error predicting final result: 'State' object has no attribute 'encoder_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'encoder_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000018D5FEC3770>

KeyError: 'encoder_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000018D5B5AD4E0>
    └ <Thread(asyncio-portal-18d60225e00, started daemon 29148)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000018D5B5AD260>
    └ <Thread(asyncio-portal-18d60225e00, started daemon 29148)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-18d60225e00, started daemon 29148)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-18d60225e00, started daemon 29148)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000018D607B9120>
    └ <Thread(asyncio-portal-18d60225e00, started daemon 29148)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000018D5C03C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D601F1A80>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x0000018D5E430CC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607B9DA0>
           │      └ <function Runner.run at 0x0000018D5E3B8860>
           └ <asyncio.runners.Runner object at 0x0000018D60183820>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018D5E3B22A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000018D60183820>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000018D5E3B2200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000018D5E3B8040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000018D5E329760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FD420>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FD420>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FD420>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D601FD420>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x0000018D6014DA80>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D601F23E0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F2520>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D601F23E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F2520>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
          └ <fastapi.applications.FastAPI object at 0x0000018D5FEC3620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607B8C20>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F2520>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607B8C20>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F2520>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018D601E5150>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B8CC0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F2520>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B8CC0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F2520>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B8CC0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F2520>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018D601816E0>>
          └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B8CC0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F2520>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │     └ <function Route.handle at 0x0000018D5EC068E0>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B8CC0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F2520>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <function request_response.<locals>.app at 0x0000018D601C1C60>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B8CC0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F2520>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    └ <starlette.requests.Request object at 0x0000018D6016AA50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607B99E0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B91C0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F2520>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607B99E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018D6016AA50>
                     └ <function get_request_handler.<locals>.app at 0x0000018D601C1B20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018D5EC2C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': FinalResultRequest(gender='M', age_band='35-55', studied_credits=120, num_of_prev_attempts=0, total_clicks=1500, avg...
                 │         └ <function predict_final_result at 0x0000018D60157740>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 32, in predict_final_result
    encoded_features = request.app.state.encoder_service.encode_finalgrade(features)
                       │       │                                           └ {'gender': 'M', 'age_band': '35-55', 'studied_credits': 120, 'num_of_prev_attempts': 0, 'total_clicks': 1500, 'avg_assessment...
                       │       └ <property object at 0x0000018D5EB52930>
                       └ <starlette.requests.Request object at 0x0000018D6016AA50>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'encoder_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000018D5FEC3770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'encoder_service'
2025-12-11 11:15:05 | ERROR    | api.router:predict_dropout:85 - Error predicting dropout: 'State' object has no attribute 'encoder_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'encoder_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000018D5FEC3770>

KeyError: 'encoder_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000018D5B5AD4E0>
    └ <Thread(asyncio-portal-18d60225810, started daemon 14520)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000018D5B5AD260>
    └ <Thread(asyncio-portal-18d60225810, started daemon 14520)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-18d60225810, started daemon 14520)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-18d60225810, started daemon 14520)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000018D607B9B20>
    └ <Thread(asyncio-portal-18d60225810, started daemon 14520)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000018D5C03C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607B9DA0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x0000018D5E430CC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D5B5AEA20>
           │      └ <function Runner.run at 0x0000018D5E3B8860>
           └ <asyncio.runners.Runner object at 0x0000018D60183820>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018D5E3B22A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000018D60183820>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000018D5E3B2200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000018D5E3B8040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000018D5E329760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607365C0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607365C0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607365C0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607365C0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x0000018D6014CD60>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607B9A80>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B93A0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607B9A80>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B93A0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
          └ <fastapi.applications.FastAPI object at 0x0000018D5FEC3620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607B91C0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B93A0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607B91C0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B93A0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018D6016A750>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B9440>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B93A0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B9440>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B93A0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B9440>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B93A0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018D601816E0>>
          └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B9440>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B93A0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │     └ <function Route.handle at 0x0000018D5EC068E0>
          └ APIRoute(path='/api/predict/dropout', name='predict_dropout', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B9440>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B93A0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <function request_response.<locals>.app at 0x0000018D601C20C0>
          └ APIRoute(path='/api/predict/dropout', name='predict_dropout', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B9440>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B93A0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │                            │    └ <starlette.requests.Request object at 0x0000018D60731130>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607B94E0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B9760>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B93A0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607B94E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018D60731130>
                     └ <function get_request_handler.<locals>.app at 0x0000018D601C2020>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018D5EC2C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': DropoutRequest(code_module='AAA', code_presentation='2013J', gender='F', region='East Anglian Region', highest_educa...
                 │         └ <function predict_dropout at 0x0000018D60157A60>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 71, in predict_dropout
    encoded_features = request.app.state.encoder_service.encode_dropout(features)
                       │       │                                        └ {'code_module': 'AAA', 'code_presentation': '2013J', 'gender': 'F', 'region': 'East Anglian Region', 'highest_education': 'HE...
                       │       └ <property object at 0x0000018D5EB52930>
                       └ <starlette.requests.Request object at 0x0000018D60731130>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'encoder_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000018D5FEC3770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'encoder_service'
2025-12-11 11:15:05 | ERROR    | api.kpi_router:get_dashboard_overview:28 - Error getting dashboard overview: 'State' object has no attribute 'kpi_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'kpi_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000018D5FEC3770>

KeyError: 'kpi_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000018D5B5AD4E0>
    └ <Thread(asyncio-portal-18d601e7020, started daemon 29380)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000018D5B5AD260>
    └ <Thread(asyncio-portal-18d601e7020, started daemon 29380)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-18d601e7020, started daemon 29380)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-18d601e7020, started daemon 29380)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000018D607B9440>
    └ <Thread(asyncio-portal-18d601e7020, started daemon 29380)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000018D5C03C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607B94E0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x0000018D5E430CC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607B9E40>
           │      └ <function Runner.run at 0x0000018D5E3B8860>
           └ <asyncio.runners.Runner object at 0x0000018D601E6E00>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018D5E3B22A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000018D601E6E00>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000018D5E3B2200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000018D5E3B8040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000018D5E329760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60735630>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60735630>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60735630>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60735630>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x0000018D60731030>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607B99E0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607B99E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
          └ <fastapi.applications.FastAPI object at 0x0000018D5FEC3620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BA3E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BA3E0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018D606633F0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018D601816E0>>
          └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │     └ <function Route.handle at 0x0000018D5EC068E0>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <function request_response.<locals>.app at 0x0000018D601C2700>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    └ <starlette.requests.Request object at 0x0000018D60C58460>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607BA660>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA700>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607BA660>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018D60C58460>
                     └ <function get_request_handler.<locals>.app at 0x0000018D601C25C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018D5EC2C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x0000018D60C58460>}
                 │         └ <function get_dashboard_overview at 0x0000018D601C0360>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 21, in get_dashboard_overview
    kpi_service = request.app.state.kpi_service
                  │       └ <property object at 0x0000018D5EB52930>
                  └ <starlette.requests.Request object at 0x0000018D60C58460>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'kpi_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000018D5FEC3770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'kpi_service'
2025-12-11 11:15:05 | ERROR    | api.kpi_router:get_student_performance:43 - Error getting student performance: 'State' object has no attribute 'kpi_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'kpi_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000018D5FEC3770>

KeyError: 'kpi_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000018D5B5AD4E0>
    └ <Thread(asyncio-portal-18d601e7460, started daemon 27248)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000018D5B5AD260>
    └ <Thread(asyncio-portal-18d601e7460, started daemon 27248)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-18d601e7460, started daemon 27248)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-18d601e7460, started daemon 27248)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000018D607BA7A0>
    └ <Thread(asyncio-portal-18d601e7460, started daemon 27248)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000018D5C03C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607BA840>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x0000018D5E430CC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607B9620>
           │      └ <function Runner.run at 0x0000018D5E3B8860>
           └ <asyncio.runners.Runner object at 0x0000018D601E7790>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018D5E3B22A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000018D601E7790>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000018D5E3B2200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000018D5E3B8040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000018D5E329760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60736C20>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60736C20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60736C20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60736C20>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x0000018D60731F30>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607B8CC0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B99E0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607B8CC0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B99E0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
          └ <fastapi.applications.FastAPI object at 0x0000018D5FEC3620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BA200>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B99E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BA200>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B99E0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018D6072C950>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA3E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B99E0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA3E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B99E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA3E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B99E0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018D601816E0>>
          └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA3E0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B99E0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │     └ <function Route.handle at 0x0000018D5EC068E0>
          └ APIRoute(path='/api/kpi/student-performance', name='get_student_performance', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA3E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B99E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <function request_response.<locals>.app at 0x0000018D601C2A20>
          └ APIRoute(path='/api/kpi/student-performance', name='get_student_performance', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA3E0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B99E0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │                            │    └ <starlette.requests.Request object at 0x0000018D6072D550>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607BA480>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA660>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B99E0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607BA480>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018D6072D550>
                     └ <function get_request_handler.<locals>.app at 0x0000018D601C28E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018D5EC2C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x0000018D6072D550>}
                 │         └ <function get_student_performance at 0x0000018D601C0680>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 36, in get_student_performance
    kpi_service = request.app.state.kpi_service
                  │       └ <property object at 0x0000018D5EB52930>
                  └ <starlette.requests.Request object at 0x0000018D6072D550>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'kpi_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000018D5FEC3770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'kpi_service'
2025-12-11 11:15:05 | ERROR    | api.kpi_router:get_module_statistics:58 - Error getting module statistics: 'State' object has no attribute 'kpi_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'kpi_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000018D5FEC3770>

KeyError: 'kpi_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000018D5B5AD4E0>
    └ <Thread(asyncio-portal-18d607e8650, started daemon 27472)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000018D5B5AD260>
    └ <Thread(asyncio-portal-18d607e8650, started daemon 27472)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-18d607e8650, started daemon 27472)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-18d607e8650, started daemon 27472)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000018D607B99E0>
    └ <Thread(asyncio-portal-18d607e8650, started daemon 27472)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000018D5C03C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607B8CC0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x0000018D5E430CC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607B94E0>
           │      └ <function Runner.run at 0x0000018D5E3B8860>
           └ <asyncio.runners.Runner object at 0x0000018D607E8350>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018D5E3B22A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000018D607E8350>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000018D5E3B2200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000018D5E3B8040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000018D5E329760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60737BB0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60737BB0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60737BB0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60737BB0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x0000018D60731F30>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607B9D00>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607B9D00>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
          └ <fastapi.applications.FastAPI object at 0x0000018D5FEC3620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BA3E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BA3E0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018D6064AF10>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018D601816E0>>
          └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │     └ <function Route.handle at 0x0000018D5EC068E0>
          └ APIRoute(path='/api/kpi/module-statistics', name='get_module_statistics', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <function request_response.<locals>.app at 0x0000018D601C2D40>
          └ APIRoute(path='/api/kpi/module-statistics', name='get_module_statistics', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA520>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │                            │    └ <starlette.requests.Request object at 0x0000018D6064B120>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607BA660>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607B9580>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607BA660>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018D6064B120>
                     └ <function get_request_handler.<locals>.app at 0x0000018D601C2C00>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018D5EC2C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x0000018D6064B120>}
                 │         └ <function get_module_statistics at 0x0000018D601C09A0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 51, in get_module_statistics
    kpi_service = request.app.state.kpi_service
                  │       └ <property object at 0x0000018D5EB52930>
                  └ <starlette.requests.Request object at 0x0000018D6064B120>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'kpi_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000018D5FEC3770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'kpi_service'
2025-12-11 11:15:05 | ERROR    | api.kpi_router:get_vle_engagement:73 - Error getting VLE engagement: 'State' object has no attribute 'kpi_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'kpi_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000018D5FEC3770>

KeyError: 'kpi_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000018D5B5AD4E0>
    └ <Thread(asyncio-portal-18d607e9050, started daemon 29128)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000018D5B5AD260>
    └ <Thread(asyncio-portal-18d607e9050, started daemon 29128)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-18d607e9050, started daemon 29128)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-18d607e9050, started daemon 29128)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000018D607B94E0>
    └ <Thread(asyncio-portal-18d607e9050, started daemon 29128)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000018D5C03C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607B99E0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x0000018D5E430CC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607BA7A0>
           │      └ <function Runner.run at 0x0000018D5E3B8860>
           └ <asyncio.runners.Runner object at 0x0000018D607E8250>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018D5E3B22A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000018D607E8250>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000018D5E3B2200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000018D5E3B8040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000018D5E329760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607F0760>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607F0760>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607F0760>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607F0760>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x0000018D60731030>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607BA840>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607BA840>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
          └ <fastapi.applications.FastAPI object at 0x0000018D5FEC3620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BAA20>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BAA20>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018D6064B6A0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BACA0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BACA0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BACA0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018D601816E0>>
          └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BACA0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │     └ <function Route.handle at 0x0000018D5EC068E0>
          └ APIRoute(path='/api/kpi/vle-engagement', name='get_vle_engagement', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BACA0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <function request_response.<locals>.app at 0x0000018D601C3060>
          └ APIRoute(path='/api/kpi/vle-engagement', name='get_vle_engagement', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BACA0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │                            │    └ <starlette.requests.Request object at 0x0000018D6064B330>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607B9EE0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BAAC0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607B9EE0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018D6064B330>
                     └ <function get_request_handler.<locals>.app at 0x0000018D601C2F20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018D5EC2C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x0000018D6064B330>}
                 │         └ <function get_vle_engagement at 0x0000018D601C0D60>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 66, in get_vle_engagement
    kpi_service = request.app.state.kpi_service
                  │       └ <property object at 0x0000018D5EB52930>
                  └ <starlette.requests.Request object at 0x0000018D6064B330>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'kpi_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000018D5FEC3770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'kpi_service'
2025-12-11 11:15:05 | ERROR    | api.kpi_router:get_assessment_summary:88 - Error getting assessment summary: 'State' object has no attribute 'kpi_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'kpi_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000018D5FEC3770>

KeyError: 'kpi_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000018D5B5AD4E0>
    └ <Thread(asyncio-portal-18d60731220, started daemon 28716)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000018D5B5AD260>
    └ <Thread(asyncio-portal-18d60731220, started daemon 28716)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-18d60731220, started daemon 28716)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-18d60731220, started daemon 28716)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000018D607B94E0>
    └ <Thread(asyncio-portal-18d60731220, started daemon 28716)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000018D5C03C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607B9620>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x0000018D5E430CC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607B9080>
           │      └ <function Runner.run at 0x0000018D5E3B8860>
           └ <asyncio.runners.Runner object at 0x0000018D607326C0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018D5E3B22A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000018D607326C0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000018D5E3B2200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000018D5E3B8040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000018D5E329760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607F1270>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607F1270>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607F1270>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D607F1270>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x0000018D60732980>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607B99E0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607B99E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
          └ <fastapi.applications.FastAPI object at 0x0000018D5FEC3620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BACA0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BACA0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018D6064B490>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BAC00>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BAC00>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BAC00>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018D601816E0>>
          └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BAC00>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │     └ <function Route.handle at 0x0000018D5EC068E0>
          └ APIRoute(path='/api/kpi/assessment-summary', name='get_assessment_summary', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BAC00>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <function request_response.<locals>.app at 0x0000018D601C3380>
          └ APIRoute(path='/api/kpi/assessment-summary', name='get_assessment_summary', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BAC00>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │                            │    └ <starlette.requests.Request object at 0x0000018D6064B8B0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607BAAC0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BA480>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607B8CC0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607BAAC0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018D6064B8B0>
                     └ <function get_request_handler.<locals>.app at 0x0000018D601C3240>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018D5EC2C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x0000018D6064B8B0>}
                 │         └ <function get_assessment_summary at 0x0000018D601C1120>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 81, in get_assessment_summary
    kpi_service = request.app.state.kpi_service
                  │       └ <property object at 0x0000018D5EB52930>
                  └ <starlette.requests.Request object at 0x0000018D6064B8B0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'kpi_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000018D5FEC3770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'kpi_service'
2025-12-11 11:15:05 | ERROR    | api.router:predict_final_result:46 - Error predicting final result: 'State' object has no attribute 'encoder_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'encoder_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000018D5FEC3770>

KeyError: 'encoder_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000018D5B5AD4E0>
    └ <Thread(asyncio-portal-18d607a90f0, started daemon 28936)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000018D5B5AD260>
    └ <Thread(asyncio-portal-18d607a90f0, started daemon 28936)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-18d607a90f0, started daemon 28936)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-18d607a90f0, started daemon 28936)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000018D607BB9C0>
    └ <Thread(asyncio-portal-18d607a90f0, started daemon 28936)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000018D5C03C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607BB420>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x0000018D5E430CC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D607BBB00>
           │      └ <function Runner.run at 0x0000018D5E3B8860>
           └ <asyncio.runners.Runner object at 0x0000018D60783CB0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018D5E3B22A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000018D60783CB0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000018D5E3B2200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000018D5E3B8040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000018D5E329760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60737550>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60737550>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60737550>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60737550>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x0000018D607333D0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607BB1A0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607BB380>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D607BB1A0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607BB380>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
          └ <fastapi.applications.FastAPI object at 0x0000018D5FEC3620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D601F0540>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607BB380>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D601F0540>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607BB380>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018D6064BC20>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F2700>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607BB380>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F2700>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607BB380>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F2700>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607BB380>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018D601816E0>>
          └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F2700>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607BB380>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │     └ <function Route.handle at 0x0000018D5EC068E0>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F2700>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607BB380>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <function request_response.<locals>.app at 0x0000018D601C1C60>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F2700>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607BB380>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    └ <starlette.requests.Request object at 0x0000018D6064BE30>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018D601F19E0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D601F1A80>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D607BB380>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018D601F19E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018D6064BE30>
                     └ <function get_request_handler.<locals>.app at 0x0000018D601C1B20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018D5EC2C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': FinalResultRequest(gender='M', age_band='35-55', studied_credits=999999, num_of_prev_attempts=100, total_clicks=1000...
                 │         └ <function predict_final_result at 0x0000018D60157740>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 32, in predict_final_result
    encoded_features = request.app.state.encoder_service.encode_finalgrade(features)
                       │       │                                           └ {'gender': 'M', 'age_band': '35-55', 'studied_credits': 999999, 'num_of_prev_attempts': 100, 'total_clicks': 1000000, 'avg_as...
                       │       └ <property object at 0x0000018D5EB52930>
                       └ <starlette.requests.Request object at 0x0000018D6064BE30>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'encoder_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000018D5FEC3770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'encoder_service'
2025-12-11 11:15:05 | ERROR    | api.router:predict_final_result:46 - Error predicting final result: 'State' object has no attribute 'encoder_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'encoder_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000018D5FEC3770>

KeyError: 'encoder_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000018D5B5AD4E0>
    └ <Thread(asyncio-portal-18d60c5a410, started daemon 9788)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000018D5B5AD260>
    └ <Thread(asyncio-portal-18d60c5a410, started daemon 9788)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-18d60c5a410, started daemon 9788)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-18d60c5a410, started daemon 9788)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000018D601F1620>
    └ <Thread(asyncio-portal-18d60c5a410, started daemon 9788)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000018D5C03C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D601F2700>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x0000018D5E430CC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000018D601F23E0>
           │      └ <function Runner.run at 0x0000018D5E3B8860>
           └ <asyncio.runners.Runner object at 0x0000018D60C58EF0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018D5E3B22A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000018D60C58EF0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000018D5E3B2200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000018D5E3B8040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000018D5E329760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60735E10>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60735E10>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60735E10>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000018D60735E10>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x0000018D607333D0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D601F19E0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000018D601F19E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
          └ <fastapi.applications.FastAPI object at 0x0000018D5FEC3620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BBCE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018D601ED6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018D607BBCE0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018D6064B5F0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018D601ED2B0>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BB380>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BB380>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000018D601ED550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BB380>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018D601816E0>>
          └ <fastapi.routing.APIRouter object at 0x0000018D601816E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BB380>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │     └ <function Route.handle at 0x0000018D5EC068E0>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BB380>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <function request_response.<locals>.app at 0x0000018D601C1C60>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BB380>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    └ <starlette.requests.Request object at 0x0000018D6064B800>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607BB420>
          └ <function wrap_app_handling_exceptions at 0x0000018D5EC05120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018D607BB9C0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000018D601F25C0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018D607BB420>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018D6064B800>
                     └ <function get_request_handler.<locals>.app at 0x0000018D601C1B20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018D5EC2C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': FinalResultRequest(gender='M', age_band='35-55', studied_credits=120, num_of_prev_attempts=0, total_clicks=1500, avg...
                 │         └ <function predict_final_result at 0x0000018D60157740>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 32, in predict_final_result
    encoded_features = request.app.state.encoder_service.encode_finalgrade(features)
                       │       │                                           └ {'gender': 'M', 'age_band': '35-55', 'studied_credits': 120, 'num_of_prev_attempts': 0, 'total_clicks': 1500, 'avg_assessment...
                       │       └ <property object at 0x0000018D5EB52930>
                       └ <starlette.requests.Request object at 0x0000018D6064B800>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'encoder_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000018D5FEC3770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'encoder_service'
2025-12-11 11:16:40 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:16:44 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x0000017422055BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000174215694E0>
    └ <Thread(asyncio-portal-174260eb610, started daemon 28528)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000017421569260>
    └ <Thread(asyncio-portal-174260eb610, started daemon 28528)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-174260eb610, started daemon 28528)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-174260eb610, started daemon 28528)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000174261618A0>
    └ <Thread(asyncio-portal-174260eb610, started daemon 28528)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000017421FFC2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426161940>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x000001742439CCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426161BC0>
           │      └ <function Runner.run at 0x0000017424324860>
           └ <asyncio.runners.Runner object at 0x00000174260EAD50>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000174243222A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000174260EAD50>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017424322200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017424324040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017423A19760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000017426171030>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000017426171030>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000017426171030>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000017426171030>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x00000174260C4C70>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426161800>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426161800>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
          └ <fastapi.applications.FastAPI object at 0x0000017425E33620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426161E40>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426161E40>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    │    └ <starlette.requests.Request object at 0x00000174260EB750>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000174260F55B0>>
          └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │     └ <function Route.handle at 0x0000017424B7A8E0>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <function request_response.<locals>.app at 0x0000017426133A60>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    └ <starlette.requests.Request object at 0x00000174260F7BB0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000174261623E0>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162660>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000174261623E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000174260F7BB0>
                     └ <function get_request_handler.<locals>.app at 0x00000174261339C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017424B9C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {}
                 │         └ <function health at 0x0000017426133880>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 63, in health
    "database_connected": db.test_connection(),
                          │  └ <function DatabaseConnection.test_connection at 0x00000174260C9940>
                          └ <core.database.DatabaseConnection object at 0x0000017425E32510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000174260C96C0>
         └ <core.database.DatabaseConnection object at 0x0000017425E32510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000001742618C820>
                └ <contextlib._GeneratorContextManager object at 0x000001742616DB70>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000017425E32510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000174260C80E0>
    └ <pymysql.connections.Connection object at 0x000001742615CAD0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:16:44 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x0000017422055BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000174215694E0>
    └ <Thread(asyncio-portal-174260eb610, started daemon 28528)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000017421569260>
    └ <Thread(asyncio-portal-174260eb610, started daemon 28528)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-174260eb610, started daemon 28528)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-174260eb610, started daemon 28528)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000174261618A0>
    └ <Thread(asyncio-portal-174260eb610, started daemon 28528)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000017421FFC2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426161940>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x000001742439CCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426161BC0>
           │      └ <function Runner.run at 0x0000017424324860>
           └ <asyncio.runners.Runner object at 0x00000174260EAD50>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000174243222A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000174260EAD50>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017424322200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017424324040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017423A19760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000017426171030>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000017426171030>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000017426171030>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000017426171030>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x00000174260C4C70>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426161800>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426161800>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
          └ <fastapi.applications.FastAPI object at 0x0000017425E33620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426161E40>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426161E40>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    │    └ <starlette.requests.Request object at 0x00000174260EB750>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000174260F55B0>>
          └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │     └ <function Route.handle at 0x0000017424B7A8E0>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <function request_response.<locals>.app at 0x0000017426133A60>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162340>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    └ <starlette.requests.Request object at 0x00000174260F7BB0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000174261623E0>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426162660>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426161440>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000174261623E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000174260F7BB0>
                     └ <function get_request_handler.<locals>.app at 0x00000174261339C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017424B9C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {}
                 │         └ <function health at 0x0000017426133880>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 63, in health
    "database_connected": db.test_connection(),
                          │  └ <function DatabaseConnection.test_connection at 0x00000174260C9940>
                          └ <core.database.DatabaseConnection object at 0x0000017425E32510>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000174260C96C0>
         └ <core.database.DatabaseConnection object at 0x0000017425E32510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000001742618C820>
                └ <contextlib._GeneratorContextManager object at 0x000001742616DB70>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000017425E32510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000174260C80E0>
    └ <pymysql.connections.Connection object at 0x000001742615CAD0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:16:44 | ERROR    | api.router:predict_final_result:46 - Error predicting final result: 'State' object has no attribute 'encoder_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'encoder_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000017425E33770>

KeyError: 'encoder_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000174215694E0>
    └ <Thread(asyncio-portal-17426199940, started daemon 27688)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000017421569260>
    └ <Thread(asyncio-portal-17426199940, started daemon 27688)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-17426199940, started daemon 27688)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-17426199940, started daemon 27688)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000017426721B20>
    └ <Thread(asyncio-portal-17426199940, started daemon 27688)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000017421FFC2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000174267225C0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x000001742439CCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426720E00>
           │      └ <function Runner.run at 0x0000017424324860>
           └ <asyncio.runners.Runner object at 0x0000017426199A70>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000174243222A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000017426199A70>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017424322200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017424324040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017423A19760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A6260>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A6260>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A6260>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A6260>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x00000174266A0C70>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426721D00>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721800>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426721D00>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721800>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
          └ <fastapi.applications.FastAPI object at 0x0000017425E33620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000174267219E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721800>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000174267219E0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721800>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    │    └ <starlette.requests.Request object at 0x0000017426156030>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426721C60>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721800>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426721C60>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721800>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426721C60>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721800>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000174260F55B0>>
          └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426721C60>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721800>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │     └ <function Route.handle at 0x0000017424B7A8E0>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426721C60>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721800>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <function request_response.<locals>.app at 0x0000017426131C60>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426721C60>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721800>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    └ <starlette.requests.Request object at 0x00000174260D3350>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000017426721BC0>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426721760>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721800>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000017426721BC0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000174260D3350>
                     └ <function get_request_handler.<locals>.app at 0x0000017426131B20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017424B9C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': FinalResultRequest(gender='M', age_band='35-55', studied_credits=120, num_of_prev_attempts=0, total_clicks=1500, avg...
                 │         └ <function predict_final_result at 0x00000174260CB740>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 32, in predict_final_result
    encoded_features = request.app.state.encoder_service.encode_finalgrade(features)
                       │       │                                           └ {'gender': 'M', 'age_band': '35-55', 'studied_credits': 120, 'num_of_prev_attempts': 0, 'total_clicks': 1500, 'avg_assessment...
                       │       └ <property object at 0x0000017424ACA890>
                       └ <starlette.requests.Request object at 0x00000174260D3350>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'encoder_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000017425E33770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'encoder_service'
2025-12-11 11:16:44 | ERROR    | api.router:predict_dropout:85 - Error predicting dropout: 'State' object has no attribute 'encoder_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'encoder_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000017425E33770>

KeyError: 'encoder_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000174215694E0>
    └ <Thread(asyncio-portal-1742619ab10, started daemon 28988)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000017421569260>
    └ <Thread(asyncio-portal-1742619ab10, started daemon 28988)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-1742619ab10, started daemon 28988)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-1742619ab10, started daemon 28988)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000017426721080>
    └ <Thread(asyncio-portal-1742619ab10, started daemon 28988)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000017421FFC2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426720E00>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x000001742439CCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x000001742156AA20>
           │      └ <function Runner.run at 0x0000017424324860>
           └ <asyncio.runners.Runner object at 0x00000174261995B0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000174243222A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000174261995B0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017424322200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017424324040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017423A19760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A5FF0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A5FF0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A5FF0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A5FF0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x00000174266A1B70>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426720B80>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721A80>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426720B80>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721A80>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
          └ <fastapi.applications.FastAPI object at 0x0000017425E33620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426721DA0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721A80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426721DA0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721A80>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │                            │    │    └ <starlette.requests.Request object at 0x00000174260D3550>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267220C0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721A80>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267220C0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721A80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267220C0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721A80>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000174260F55B0>>
          └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267220C0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721A80>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │     └ <function Route.handle at 0x0000017424B7A8E0>
          └ APIRoute(path='/api/predict/dropout', name='predict_dropout', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267220C0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721A80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <function request_response.<locals>.app at 0x00000174261320C0>
          └ APIRoute(path='/api/predict/dropout', name='predict_dropout', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267220C0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721A80>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │                            │    └ <starlette.requests.Request object at 0x00000174266A19A0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000017426721EE0>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722160>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721A80>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000017426721EE0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000174266A19A0>
                     └ <function get_request_handler.<locals>.app at 0x0000017426132020>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017424B9C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': DropoutRequest(code_module='AAA', code_presentation='2013J', gender='F', region='East Anglian Region', highest_educa...
                 │         └ <function predict_dropout at 0x00000174260CBA60>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 71, in predict_dropout
    encoded_features = request.app.state.encoder_service.encode_dropout(features)
                       │       │                                        └ {'code_module': 'AAA', 'code_presentation': '2013J', 'gender': 'F', 'region': 'East Anglian Region', 'highest_education': 'HE...
                       │       └ <property object at 0x0000017424ACA890>
                       └ <starlette.requests.Request object at 0x00000174266A19A0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'encoder_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000017425E33770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'encoder_service'
2025-12-11 11:16:44 | ERROR    | api.kpi_router:get_dashboard_overview:28 - Error getting dashboard overview: 'State' object has no attribute 'kpi_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'kpi_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000017425E33770>

KeyError: 'kpi_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000174215694E0>
    └ <Thread(asyncio-portal-17426157680, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000017421569260>
    └ <Thread(asyncio-portal-17426157680, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-17426157680, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-17426157680, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000017426721EE0>
    └ <Thread(asyncio-portal-17426157680, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000017421FFC2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000174267220C0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x000001742439CCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426722700>
           │      └ <function Runner.run at 0x0000017424324860>
           └ <asyncio.runners.Runner object at 0x0000017426157460>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000174243222A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000017426157460>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017424322200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017424324040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017423A19760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A65C0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A65C0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A65C0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A65C0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x00000174266A1E40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426721BC0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721C60>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426721BC0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721C60>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
          └ <fastapi.applications.FastAPI object at 0x0000017425E33620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426722C00>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721C60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426722C00>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721C60>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    │    └ <starlette.requests.Request object at 0x00000174266F0130>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721C60>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721C60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721C60>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000174260F55B0>>
          └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721C60>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │     └ <function Route.handle at 0x0000017424B7A8E0>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721C60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <function request_response.<locals>.app at 0x0000017426132700>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721C60>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    └ <starlette.requests.Request object at 0x0000017426BC8460>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000017426722DE0>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722F20>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426721C60>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000017426722DE0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000017426BC8460>
                     └ <function get_request_handler.<locals>.app at 0x00000174261325C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017424B9C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x0000017426BC8460>}
                 │         └ <function get_dashboard_overview at 0x0000017426130360>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 21, in get_dashboard_overview
    kpi_service = request.app.state.kpi_service
                  │       └ <property object at 0x0000017424ACA890>
                  └ <starlette.requests.Request object at 0x0000017426BC8460>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'kpi_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000017425E33770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'kpi_service'
2025-12-11 11:16:44 | ERROR    | api.kpi_router:get_student_performance:43 - Error getting student performance: 'State' object has no attribute 'kpi_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'kpi_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000017425E33770>

KeyError: 'kpi_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000174215694E0>
    └ <Thread(asyncio-portal-17426157ac0, started daemon 10228)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000017421569260>
    └ <Thread(asyncio-portal-17426157ac0, started daemon 10228)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-17426157ac0, started daemon 10228)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-17426157ac0, started daemon 10228)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000017426723060>
    └ <Thread(asyncio-portal-17426157ac0, started daemon 10228)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000017421FFC2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426721C60>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x000001742439CCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000174267220C0>
           │      └ <function Runner.run at 0x0000017424324860>
           └ <asyncio.runners.Runner object at 0x0000017426157DF0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000174243222A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000017426157DF0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017424322200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017424324040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017423A19760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A7AF0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A7AF0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A7AF0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000174266A7AF0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x00000174266A16C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426721BC0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426721BC0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
          └ <fastapi.applications.FastAPI object at 0x0000017425E33620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426722980>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426722980>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │                            │    │    └ <starlette.requests.Request object at 0x000001742669D550>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000174260F55B0>>
          └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │     └ <function Route.handle at 0x0000017424B7A8E0>
          └ APIRoute(path='/api/kpi/student-performance', name='get_student_performance', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <function request_response.<locals>.app at 0x0000017426132A20>
          └ APIRoute(path='/api/kpi/student-performance', name='get_student_performance', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │                            │    └ <starlette.requests.Request object at 0x000001742669C350>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000017426722CA0>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722DE0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000017426722CA0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001742669C350>
                     └ <function get_request_handler.<locals>.app at 0x00000174261328E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017424B9C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000001742669C350>}
                 │         └ <function get_student_performance at 0x0000017426130680>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 36, in get_student_performance
    kpi_service = request.app.state.kpi_service
                  │       └ <property object at 0x0000017424ACA890>
                  └ <starlette.requests.Request object at 0x000001742669C350>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'kpi_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000017425E33770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'kpi_service'
2025-12-11 11:16:44 | ERROR    | api.kpi_router:get_module_statistics:58 - Error getting module statistics: 'State' object has no attribute 'kpi_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'kpi_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000017425E33770>

KeyError: 'kpi_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000174215694E0>
    └ <Thread(asyncio-portal-17426758450, started daemon 28168)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000017421569260>
    └ <Thread(asyncio-portal-17426758450, started daemon 28168)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-17426758450, started daemon 28168)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-17426758450, started daemon 28168)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000017426721C60>
    └ <Thread(asyncio-portal-17426758450, started daemon 28168)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000017421FFC2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000174267228E0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x000001742439CCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426723060>
           │      └ <function Runner.run at 0x0000017424324860>
           └ <asyncio.runners.Runner object at 0x0000017426758950>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000174243222A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000017426758950>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017424322200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017424324040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017423A19760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675C7F0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675C7F0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675C7F0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675C7F0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x00000174266A36A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426721BC0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722700>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426721BC0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722700>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
          └ <fastapi.applications.FastAPI object at 0x0000017425E33620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426722C00>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722700>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426722C00>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722700>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │                            │    │    └ <starlette.requests.Request object at 0x00000174265BB280>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722700>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722700>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722700>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000174260F55B0>>
          └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722700>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │     └ <function Route.handle at 0x0000017424B7A8E0>
          └ APIRoute(path='/api/kpi/module-statistics', name='get_module_statistics', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722700>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <function request_response.<locals>.app at 0x0000017426132D40>
          └ APIRoute(path='/api/kpi/module-statistics', name='get_module_statistics', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722D40>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722700>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │                            │    └ <starlette.requests.Request object at 0x00000174265BB490>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000017426722DE0>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722020>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722700>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000017426722DE0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000174265BB490>
                     └ <function get_request_handler.<locals>.app at 0x0000017426132C00>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017424B9C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x00000174265BB490>}
                 │         └ <function get_module_statistics at 0x00000174261309A0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 51, in get_module_statistics
    kpi_service = request.app.state.kpi_service
                  │       └ <property object at 0x0000017424ACA890>
                  └ <starlette.requests.Request object at 0x00000174265BB490>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'kpi_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000017425E33770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'kpi_service'
2025-12-11 11:16:44 | ERROR    | api.kpi_router:get_vle_engagement:73 - Error getting VLE engagement: 'State' object has no attribute 'kpi_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'kpi_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000017425E33770>

KeyError: 'kpi_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000174215694E0>
    └ <Thread(asyncio-portal-17426758d50, started daemon 28828)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000017421569260>
    └ <Thread(asyncio-portal-17426758d50, started daemon 28828)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-17426758d50, started daemon 28828)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-17426758d50, started daemon 28828)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000017426723060>
    └ <Thread(asyncio-portal-17426758d50, started daemon 28828)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000017421FFC2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426721C60>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x000001742439CCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000174267220C0>
           │      └ <function Runner.run at 0x0000017424324860>
           └ <asyncio.runners.Runner object at 0x0000017426759850>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000174243222A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000017426759850>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017424322200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017424324040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017423A19760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675CE50>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675CE50>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675CE50>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675CE50>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x00000174266A3C40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426722FC0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426722FC0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
          └ <fastapi.applications.FastAPI object at 0x0000017425E33620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000174267227A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000174267227A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │                            │    │    └ <starlette.requests.Request object at 0x00000174265BB5F0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267232E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267232E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267232E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000174260F55B0>>
          └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267232E0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │     └ <function Route.handle at 0x0000017424B7A8E0>
          └ APIRoute(path='/api/kpi/vle-engagement', name='get_vle_engagement', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267232E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <function request_response.<locals>.app at 0x0000017426133060>
          └ APIRoute(path='/api/kpi/vle-engagement', name='get_vle_engagement', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267232E0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │                            │    └ <starlette.requests.Request object at 0x00000174265BB6A0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000017426722020>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426723380>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000174267228E0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000017426722020>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000174265BB6A0>
                     └ <function get_request_handler.<locals>.app at 0x0000017426132F20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017424B9C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x00000174265BB6A0>}
                 │         └ <function get_vle_engagement at 0x0000017426130D60>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 66, in get_vle_engagement
    kpi_service = request.app.state.kpi_service
                  │       └ <property object at 0x0000017424ACA890>
                  └ <starlette.requests.Request object at 0x00000174265BB6A0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'kpi_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000017425E33770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'kpi_service'
2025-12-11 11:16:44 | ERROR    | api.kpi_router:get_assessment_summary:88 - Error getting assessment summary: 'State' object has no attribute 'kpi_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'kpi_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000017425E33770>

KeyError: 'kpi_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000174215694E0>
    └ <Thread(asyncio-portal-174266a3f20, started daemon 27356)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000017421569260>
    └ <Thread(asyncio-portal-174266a3f20, started daemon 27356)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-174266a3f20, started daemon 27356)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-174266a3f20, started daemon 27356)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000017426721EE0>
    └ <Thread(asyncio-portal-174266a3f20, started daemon 27356)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000017421FFC2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426721C60>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x000001742439CCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426720C20>
           │      └ <function Runner.run at 0x0000017424324860>
           └ <asyncio.runners.Runner object at 0x00000174266A3C50>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000174243222A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000174266A3C50>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017424322200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017424324040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017423A19760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675DD80>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675DD80>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675DD80>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675DD80>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x00000174266A31F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000174267228E0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722FC0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000174267228E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722FC0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
          └ <fastapi.applications.FastAPI object at 0x0000017425E33620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000174267232E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722FC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000174267232E0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722FC0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │                            │    │    └ <starlette.requests.Request object at 0x00000174265BB3E0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267234C0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722FC0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267234C0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722FC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267234C0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722FC0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000174260F55B0>>
          └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267234C0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722FC0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │     └ <function Route.handle at 0x0000017424B7A8E0>
          └ APIRoute(path='/api/kpi/assessment-summary', name='get_assessment_summary', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267234C0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722FC0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <function request_response.<locals>.app at 0x0000017426133380>
          └ APIRoute(path='/api/kpi/assessment-summary', name='get_assessment_summary', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000174267234C0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722FC0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │                            │    └ <starlette.requests.Request object at 0x00000174265BB800>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000017426723380>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426723560>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426722FC0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000017426723380>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000174265BB800>
                     └ <function get_request_handler.<locals>.app at 0x0000017426133240>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017424B9C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x00000174265BB800>}
                 │         └ <function get_assessment_summary at 0x0000017426131120>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 81, in get_assessment_summary
    kpi_service = request.app.state.kpi_service
                  │       └ <property object at 0x0000017424ACA890>
                  └ <starlette.requests.Request object at 0x00000174265BB800>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'kpi_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000017425E33770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'kpi_service'
2025-12-11 11:16:44 | ERROR    | api.router:predict_final_result:46 - Error predicting final result: 'State' object has no attribute 'encoder_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'encoder_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000017425E33770>

KeyError: 'encoder_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000174215694E0>
    └ <Thread(asyncio-portal-174266f3d90, started daemon 28980)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000017421569260>
    └ <Thread(asyncio-portal-174266f3d90, started daemon 28980)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-174266f3d90, started daemon 28980)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-174266f3d90, started daemon 28980)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x0000017426723380>
    └ <Thread(asyncio-portal-174266f3d90, started daemon 28980)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000017421FFC2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426723CE0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x000001742439CCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000174267AC400>
           │      └ <function Runner.run at 0x0000017424324860>
           └ <asyncio.runners.Runner object at 0x0000017426718910>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000174243222A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000017426718910>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017424322200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017424324040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017423A19760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675F8B0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675F8B0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675F8B0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675F8B0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x00000174266A32E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426723A60>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426723A60>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
          └ <fastapi.applications.FastAPI object at 0x0000017425E33620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426723C40>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017426723C40>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    │    └ <starlette.requests.Request object at 0x0000017425E5DFF0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000174260F55B0>>
          └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │     └ <function Route.handle at 0x0000017424B7A8E0>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <function request_response.<locals>.app at 0x0000017426131C60>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722C00>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    └ <starlette.requests.Request object at 0x0000017425E5E150>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000017426723E20>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426723EC0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000017426723E20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000017425E5E150>
                     └ <function get_request_handler.<locals>.app at 0x0000017426131B20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017424B9C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': FinalResultRequest(gender='M', age_band='35-55', studied_credits=999999, num_of_prev_attempts=100, total_clicks=1000...
                 │         └ <function predict_final_result at 0x00000174260CB740>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 32, in predict_final_result
    encoded_features = request.app.state.encoder_service.encode_finalgrade(features)
                       │       │                                           └ {'gender': 'M', 'age_band': '35-55', 'studied_credits': 999999, 'num_of_prev_attempts': 100, 'total_clicks': 1000000, 'avg_as...
                       │       └ <property object at 0x0000017424ACA890>
                       └ <starlette.requests.Request object at 0x0000017425E5E150>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'encoder_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000017425E33770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'encoder_service'
2025-12-11 11:16:44 | ERROR    | api.router:predict_final_result:46 - Error predicting final result: 'State' object has no attribute 'encoder_service'
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 685, in __getattr__
    return self._state[key]
           │    │      └ 'encoder_service'
           │    └ {}
           └ <starlette.datastructures.State object at 0x0000017425E33770>

KeyError: 'encoder_service'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000174215694E0>
    └ <Thread(asyncio-portal-17426bca820, started daemon 19444)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000017421569260>
    └ <Thread(asyncio-portal-17426bca820, started daemon 19444)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-17426bca820, started daemon 19444)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-17426bca820, started daemon 19444)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000174267239C0>
    └ <Thread(asyncio-portal-17426bca820, started daemon 19444)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x0000017421FFC2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426723CE0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x000001742439CCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x0000017426722020>
           │      └ <function Runner.run at 0x0000017424324860>
           └ <asyncio.runners.Runner object at 0x0000017426BC97E0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000174243222A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000017426BC97E0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017424322200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017424324040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017423A19760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675F160>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675F160>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675F160>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000001742675F160>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x00000174266A3100>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426723380>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000017426723380>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
          └ <fastapi.applications.FastAPI object at 0x0000017425E33620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000174267234C0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001742615D7F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000174267234C0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    │    └ <starlette.requests.Request object at 0x00000174265BBEE0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001742615D400>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722A20>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722A20>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000001742615D6A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722A20>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000174260F55B0>>
          └ <fastapi.routing.APIRouter object at 0x00000174260F55B0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722A20>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │     └ <function Route.handle at 0x0000017424B7A8E0>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722A20>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <function request_response.<locals>.app at 0x0000017426131C60>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426722A20>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    └ <starlette.requests.Request object at 0x00000174265BB800>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000017426720C20>
          └ <function wrap_app_handling_exceptions at 0x0000017424B79120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017426721EE0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000017426723D80>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000017426720C20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000174265BB800>
                     └ <function get_request_handler.<locals>.app at 0x0000017426131B20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017424B9C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': FinalResultRequest(gender='M', age_band='35-55', studied_credits=120, num_of_prev_attempts=0, total_clicks=1500, avg...
                 │         └ <function predict_final_result at 0x00000174260CB740>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 32, in predict_final_result
    encoded_features = request.app.state.encoder_service.encode_finalgrade(features)
                       │       │                                           └ {'gender': 'M', 'age_band': '35-55', 'studied_credits': 120, 'num_of_prev_attempts': 0, 'total_clicks': 1500, 'avg_assessment...
                       │       └ <property object at 0x0000017424ACA890>
                       └ <starlette.requests.Request object at 0x00000174265BB800>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\datastructures.py", line 688, in __getattr__
    raise AttributeError(message.format(self.__class__.__name__, key))
                         │       │      │    │         │         └ 'encoder_service'
                         │       │      │    │         └ <member '__name__' of 'getset_descriptor' objects>
                         │       │      │    └ <attribute '__class__' of 'object' objects>
                         │       │      └ <starlette.datastructures.State object at 0x0000017425E33770>
                         │       └ <method 'format' of 'str' objects>
                         └ "'{}' object has no attribute '{}'"

AttributeError: 'State' object has no attribute 'encoder_service'
2025-12-11 11:17:59 | INFO     | app:lifespan:41 - Shutting down the application...
2025-12-11 11:18:00 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:18:01 | INFO     | app:lifespan:16 - Starting up the application...
2025-12-11 11:18:01 | INFO     | app:lifespan:19 - Testing database connection...
2025-12-11 11:18:05 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000161511D5440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x00000161512349A0>
                                      └ <function spawn_main at 0x00000161512349A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 324
               │     └ 3
               └ <function _main at 0x0000016151234A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 324
           │    └ <function BaseProcess._bootstrap at 0x0000016150ED82C0>
           └ <SpawnProcess name='SpawnProcess-6' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000016150ED37E0>
    └ <SpawnProcess name='SpawnProcess-6' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000016154711550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-6' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-6' parent=27408 started>
    │    └ <function subprocess_started at 0x00000161547337E0>
    └ <SpawnProcess name='SpawnProcess-6' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=412, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000161547116A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x00000161546FADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x0000016154711550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x00000161547116A0>
           │           │    │             └ [<socket.socket fd=412, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x0000016154732980>
           │           └ <uvicorn.server.Server object at 0x00000161547116A0>
           └ <function run at 0x000001615197CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000016150D3BA00>
           │      └ <function Runner.run at 0x00000161533E0FE0>
           └ <asyncio.runners.Runner object at 0x0000016154712120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000161533DEA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000016154712120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000161533DE980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000161533E07C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000016151AA2020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000016154505000>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000016154505000>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000016154505000>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000016154505000>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x00000161547CB560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>
          │   │      │    └ <function LifespanOn.receive at 0x00000161547CB600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000016154713230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x0000016154775D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000016154713230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000161547EC2F0>
          └ <fastapi.applications.FastAPI object at 0x0000016154775D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000161547EC1A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000161547EC2F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x00000161547EC050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000161547EC1A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x0000016154722210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x00000161547EC050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000016154722210>>
          └ <fastapi.routing.APIRouter object at 0x0000016154722210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x00000161543ADBC0>
          └ <fastapi.routing.APIRouter object at 0x0000016154722210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x0000016154775D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000161547D9800>
               └ <fastapi.routing.APIRouter object at 0x0000016154722210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000161546A7DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000161547EC440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000016154775D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000161547D8680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000161546A7AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000016154777890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000016154775D10>
               └ <function lifespan at 0x00000161547CB740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x000001615473E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000161547779D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x0000016154582520>
       └ <core.database.DatabaseConnection object at 0x00000161545023C0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000161545822A0>
         └ <core.database.DatabaseConnection object at 0x00000161545023C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x00000161547D2DC0>
                └ <contextlib._GeneratorContextManager object at 0x000001615477EAC0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x00000161545023C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x0000016154580CC0>
    └ <pymysql.connections.Connection object at 0x00000161547EC590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:05 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000161511D5440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x00000161512349A0>
                                      └ <function spawn_main at 0x00000161512349A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 324
               │     └ 3
               └ <function _main at 0x0000016151234A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 324
           │    └ <function BaseProcess._bootstrap at 0x0000016150ED82C0>
           └ <SpawnProcess name='SpawnProcess-6' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000016150ED37E0>
    └ <SpawnProcess name='SpawnProcess-6' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000016154711550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-6' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-6' parent=27408 started>
    │    └ <function subprocess_started at 0x00000161547337E0>
    └ <SpawnProcess name='SpawnProcess-6' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=412, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000161547116A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x00000161546FADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x0000016154711550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x00000161547116A0>
           │           │    │             └ [<socket.socket fd=412, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x0000016154732980>
           │           └ <uvicorn.server.Server object at 0x00000161547116A0>
           └ <function run at 0x000001615197CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000016150D3BA00>
           │      └ <function Runner.run at 0x00000161533E0FE0>
           └ <asyncio.runners.Runner object at 0x0000016154712120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000161533DEA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000016154712120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000161533DE980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000161533E07C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000016151AA2020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000016154505000>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000016154505000>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000016154505000>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000016154505000>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x00000161547CB560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>
          │   │      │    └ <function LifespanOn.receive at 0x00000161547CB600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000016154713230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x0000016154775D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000016154713230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000161547EC2F0>
          └ <fastapi.applications.FastAPI object at 0x0000016154775D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000161547EC1A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000161547EC2F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x00000161547EC050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000161547EC1A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x0000016154722210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x00000161547EC050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000016154722210>>
          └ <fastapi.routing.APIRouter object at 0x0000016154722210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000016154713A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x00000161543ADBC0>
          └ <fastapi.routing.APIRouter object at 0x0000016154722210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x0000016154775D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000161547D9800>
               └ <fastapi.routing.APIRouter object at 0x0000016154722210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000161546A7DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000161547EC440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000016154775D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000161547D8680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000161546A7AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000016154777890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000016154775D10>
               └ <function lifespan at 0x00000161547CB740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x000001615473E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000161547779D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x0000016154582520>
       └ <core.database.DatabaseConnection object at 0x00000161545023C0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000161545822A0>
         └ <core.database.DatabaseConnection object at 0x00000161545023C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x00000161547D2DC0>
                └ <contextlib._GeneratorContextManager object at 0x000001615477EAC0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x00000161545023C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x0000016154580CC0>
    └ <pymysql.connections.Connection object at 0x00000161547EC590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:05 | ERROR    | app:lifespan:23 - Database connection failed
2025-12-11 11:18:05 | INFO     | app:lifespan:25 - Loading models...
2025-12-11 11:18:07 | SUCCESS  | app:lifespan:27 - Models loaded successfully.
2025-12-11 11:18:07 | INFO     | app:lifespan:30 - Initializing services...
2025-12-11 11:18:07 | SUCCESS  | app:lifespan:36 - Services initialized successfully.
2025-12-11 11:18:08 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:18:08 | INFO     | app:lifespan:16 - Starting up the application...
2025-12-11 11:18:08 | INFO     | app:lifespan:19 - Testing database connection...
2025-12-11 11:18:12 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x0000024340F95440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x0000024340FF49A0>
                                      └ <function spawn_main at 0x0000024340FF49A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 332
               │     └ 3
               └ <function _main at 0x0000024340FF4A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 332
           │    └ <function BaseProcess._bootstrap at 0x0000024340CA82C0>
           └ <SpawnProcess name='SpawnProcess-7' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000024340CA37E0>
    └ <SpawnProcess name='SpawnProcess-7' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000024344471550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-7' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-7' parent=27408 started>
    │    └ <function subprocess_started at 0x00000243444937E0>
    └ <SpawnProcess name='SpawnProcess-7' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=428, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000243444716A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x000002434445ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x0000024344471550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x00000243444716A0>
           │           │    │             └ [<socket.socket fd=428, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x0000024344492980>
           │           └ <uvicorn.server.Server object at 0x00000243444716A0>
           └ <function run at 0x000002434172CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000024340B0BA00>
           │      └ <function Runner.run at 0x00000243430A0FE0>
           └ <asyncio.runners.Runner object at 0x0000024344472120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002434309EA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000024344472120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000002434309E980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000243430A07C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000024341852020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024344489CC0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024344489CC0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024344489CC0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024344489CC0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x000002434453B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>
          │   │      │    └ <function LifespanOn.receive at 0x000002434453B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000024344473230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x00000243444D5D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000024344473230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002434455C2F0>
          └ <fastapi.applications.FastAPI object at 0x00000243444D5D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002434455C1A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002434455C2F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000002434455C050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002434455C1A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x0000024344482210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000002434455C050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000024344482210>>
          └ <fastapi.routing.APIRouter object at 0x0000024344482210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x000002434410DBC0>
          └ <fastapi.routing.APIRouter object at 0x0000024344482210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x00000243444D5D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000024344549800>
               └ <fastapi.routing.APIRouter object at 0x0000024344482210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000024344407DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000002434455C440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x00000243444D5D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000024344548680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000024344407AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000243444D7890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x00000243444D5D10>
               └ <function lifespan at 0x000002434453B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x000002434449E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000243444D79D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x00000243442E2520>
       └ <core.database.DatabaseConnection object at 0x00000243442663C0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000243442E22A0>
         └ <core.database.DatabaseConnection object at 0x00000243442663C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x0000024344542DC0>
                └ <contextlib._GeneratorContextManager object at 0x00000243444DEAC0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x00000243442663C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000243442E0CC0>
    └ <pymysql.connections.Connection object at 0x000002434455C590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:12 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x0000024340F95440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x0000024340FF49A0>
                                      └ <function spawn_main at 0x0000024340FF49A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 332
               │     └ 3
               └ <function _main at 0x0000024340FF4A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 332
           │    └ <function BaseProcess._bootstrap at 0x0000024340CA82C0>
           └ <SpawnProcess name='SpawnProcess-7' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000024340CA37E0>
    └ <SpawnProcess name='SpawnProcess-7' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000024344471550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-7' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-7' parent=27408 started>
    │    └ <function subprocess_started at 0x00000243444937E0>
    └ <SpawnProcess name='SpawnProcess-7' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=428, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000243444716A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x000002434445ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x0000024344471550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x00000243444716A0>
           │           │    │             └ [<socket.socket fd=428, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x0000024344492980>
           │           └ <uvicorn.server.Server object at 0x00000243444716A0>
           └ <function run at 0x000002434172CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000024340B0BA00>
           │      └ <function Runner.run at 0x00000243430A0FE0>
           └ <asyncio.runners.Runner object at 0x0000024344472120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002434309EA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000024344472120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000002434309E980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000243430A07C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000024341852020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024344489CC0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024344489CC0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024344489CC0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000024344489CC0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x000002434453B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>
          │   │      │    └ <function LifespanOn.receive at 0x000002434453B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000024344473230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x00000243444D5D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000024344473230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002434455C2F0>
          └ <fastapi.applications.FastAPI object at 0x00000243444D5D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002434455C1A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002434455C2F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000002434455C050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002434455C1A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x0000024344482210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x000002434455C050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000024344482210>>
          └ <fastapi.routing.APIRouter object at 0x0000024344482210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000024344473A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x000002434410DBC0>
          └ <fastapi.routing.APIRouter object at 0x0000024344482210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x00000243444D5D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000024344549800>
               └ <fastapi.routing.APIRouter object at 0x0000024344482210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000024344407DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000002434455C440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x00000243444D5D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000024344548680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000024344407AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000243444D7890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x00000243444D5D10>
               └ <function lifespan at 0x000002434453B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x000002434449E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000243444D79D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x00000243442E2520>
       └ <core.database.DatabaseConnection object at 0x00000243442663C0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000243442E22A0>
         └ <core.database.DatabaseConnection object at 0x00000243442663C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x0000024344542DC0>
                └ <contextlib._GeneratorContextManager object at 0x00000243444DEAC0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x00000243442663C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000243442E0CC0>
    └ <pymysql.connections.Connection object at 0x000002434455C590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:12 | ERROR    | app:lifespan:23 - Database connection failed
2025-12-11 11:18:12 | INFO     | app:lifespan:25 - Loading models...
2025-12-11 11:18:14 | SUCCESS  | app:lifespan:27 - Models loaded successfully.
2025-12-11 11:18:14 | INFO     | app:lifespan:30 - Initializing services...
2025-12-11 11:18:14 | SUCCESS  | app:lifespan:36 - Services initialized successfully.
2025-12-11 11:18:25 | INFO     | app:lifespan:41 - Shutting down the application...
2025-12-11 11:18:26 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:18:26 | INFO     | app:lifespan:16 - Starting up the application...
2025-12-11 11:18:26 | INFO     | app:lifespan:19 - Testing database connection...
2025-12-11 11:18:30 | INFO     | core.database:__init__:26 - Database config initialized: localhost:3008/capstone_kpi
2025-12-11 11:18:30 | INFO     | app:lifespan:16 - Starting up the application...
2025-12-11 11:18:30 | INFO     | app:lifespan:19 - Testing database connection...
2025-12-11 11:18:30 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x0000019F66375440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x0000019F663D09A0>
                                      └ <function spawn_main at 0x0000019F663D09A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 204
               │     └ 3
               └ <function _main at 0x0000019F663D0A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 204
           │    └ <function BaseProcess._bootstrap at 0x0000019F660582C0>
           └ <SpawnProcess name='SpawnProcess-8' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000019F660537E0>
    └ <SpawnProcess name='SpawnProcess-8' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000019F69841550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-8' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-8' parent=27408 started>
    │    └ <function subprocess_started at 0x0000019F698637E0>
    └ <SpawnProcess name='SpawnProcess-8' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=416, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000019F698416A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x0000019F6982ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x0000019F69841550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x0000019F698416A0>
           │           │    │             └ [<socket.socket fd=416, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x0000019F69862980>
           │           └ <uvicorn.server.Server object at 0x0000019F698416A0>
           └ <function run at 0x0000019F66B1CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000019F65EBBA00>
           │      └ <function Runner.run at 0x0000019F684C0FE0>
           └ <asyncio.runners.Runner object at 0x0000019F69842120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000019F684BEA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000019F69842120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000019F684BE980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000019F684C07C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000019F66C42020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000019F6971D5A0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000019F6971D5A0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000019F6971D5A0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000019F6971D5A0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x0000019F6992B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>
          │   │      │    └ <function LifespanOn.receive at 0x0000019F6992B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000019F69843230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x0000019F698A5D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000019F69843230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000019F6994C2F0>
          └ <fastapi.applications.FastAPI object at 0x0000019F698A5D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019F6994C1A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000019F6994C2F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000019F6994C050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019F6994C1A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x0000019F69852210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000019F6994C050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000019F69852210>>
          └ <fastapi.routing.APIRouter object at 0x0000019F69852210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x0000019F694BDBC0>
          └ <fastapi.routing.APIRouter object at 0x0000019F69852210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x0000019F698A5D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000019F69939800>
               └ <fastapi.routing.APIRouter object at 0x0000019F69852210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000019F697C7DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000019F6994C440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000019F698A5D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000019F69938680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000019F697C7AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000019F698A7890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000019F698A5D10>
               └ <function lifespan at 0x0000019F6992B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x0000019F6986E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000019F698A79D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x0000019F69692520>
       └ <core.database.DatabaseConnection object at 0x0000019F696163C0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x0000019F696922A0>
         └ <core.database.DatabaseConnection object at 0x0000019F696163C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x0000019F69932DC0>
                └ <contextlib._GeneratorContextManager object at 0x0000019F698AEAC0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000019F696163C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x0000019F69690CC0>
    └ <pymysql.connections.Connection object at 0x0000019F6994C590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:30 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x0000019F66375440>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=27408, pipe_handle=608)
                                      │           └ <function spawn_main at 0x0000019F663D09A0>
                                      └ <function spawn_main at 0x0000019F663D09A0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 204
               │     └ 3
               └ <function _main at 0x0000019F663D0A40>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 204
           │    └ <function BaseProcess._bootstrap at 0x0000019F660582C0>
           └ <SpawnProcess name='SpawnProcess-8' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000019F660537E0>
    └ <SpawnProcess name='SpawnProcess-8' parent=27408 started>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000019F69841550>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-8' parent=27408 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-8' parent=27408 started>
    │    └ <function subprocess_started at 0x0000019F698637E0>
    └ <SpawnProcess name='SpawnProcess-8' parent=27408 started>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=416, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000019F698416A0>>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           │           │    │             │                      │    │      └ <function Config.get_loop_factory at 0x0000019F6982ADE0>
           │           │    │             │                      │    └ <uvicorn.config.Config object at 0x0000019F69841550>
           │           │    │             │                      └ <uvicorn.server.Server object at 0x0000019F698416A0>
           │           │    │             └ [<socket.socket fd=416, family=2, type=1, proto=6, laddr=('0.0.0.0', 8000)>]
           │           │    └ <function Server.serve at 0x0000019F69862980>
           │           └ <uvicorn.server.Server object at 0x0000019F698416A0>
           └ <function run at 0x0000019F66B1CEA0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000019F65EBBA00>
           │      └ <function Runner.run at 0x0000019F684C0FE0>
           └ <asyncio.runners.Runner object at 0x0000019F69842120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-package...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000019F684BEA20>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000019F69842120>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000019F684BE980>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000019F684C07C0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000019F66C42020>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000019F6971D5A0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000019F6971D5A0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000019F6971D5A0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000019F6971D5A0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\lifespan\on.py", line 86, in main
    await app(scope, self.receive, self.send)
          │   │      │    │        │    └ <function LifespanOn.send at 0x0000019F6992B560>
          │   │      │    │        └ <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>
          │   │      │    └ <function LifespanOn.receive at 0x0000019F6992B600>
          │   │      └ <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>
          │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000019F69843230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 29, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
                 │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
                 │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
                 │    └ <fastapi.applications.FastAPI object at 0x0000019F698A5D10>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000019F69843230>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
                           │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
                           └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000019F6994C2F0>
          └ <fastapi.applications.FastAPI object at 0x0000019F698A5D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019F6994C1A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000019F6994C2F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000019F6994C050>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019F6994C1A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │   └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <fastapi.routing.APIRouter object at 0x0000019F69852210>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000019F6994C050>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │                │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │                └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000019F69852210>>
          └ <fastapi.routing.APIRouter object at 0x0000019F69852210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method LifespanOn.send of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │        │      └ <bound method LifespanOn.receive of <uvicorn.lifespan.on.LifespanOn object at 0x0000019F69843A10>>
          │    │        └ {'type': 'lifespan', 'asgi': {'version': '3.0', 'spec_version': '2.0'}, 'state': {}, 'app': <fastapi.applications.FastAPI obj...
          │    └ <function Router.lifespan at 0x0000019F694BDBC0>
          └ <fastapi.routing.APIRouter object at 0x0000019F69852210>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x0000019F698A5D10>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000019F69939800>
               └ <fastapi.routing.APIRouter object at 0x0000019F69852210>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000019F697C7DE0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000019F6994C440>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000019F698A5D10>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x0000019F69938680>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x0000019F697C7AB0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000019F698A7890>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000019F698A5D10>
               └ <function lifespan at 0x0000019F6992B740>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x0000019F6986E4D0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x0000019F698A79D0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x0000019F69692520>
       └ <core.database.DatabaseConnection object at 0x0000019F696163C0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x0000019F696922A0>
         └ <core.database.DatabaseConnection object at 0x0000019F696163C0>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x0000019F69932DC0>
                └ <contextlib._GeneratorContextManager object at 0x0000019F698AEAC0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000019F696163C0>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x0000019F69690CC0>
    └ <pymysql.connections.Connection object at 0x0000019F6994C590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:31 | ERROR    | app:lifespan:23 - Database connection failed
2025-12-11 11:18:31 | INFO     | app:lifespan:25 - Loading models...
2025-12-11 11:18:32 | SUCCESS  | app:lifespan:27 - Models loaded successfully.
2025-12-11 11:18:32 | INFO     | app:lifespan:30 - Initializing services...
2025-12-11 11:18:32 | SUCCESS  | app:lifespan:36 - Services initialized successfully.
2025-12-11 11:18:35 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle Task.task_wakeup()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object TestClient.lifespan at 0x0000028465206420>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\testclient.py", line 704, in lifespan
    await self.app(scope, self.stream_receive.receive, self.stream_send.send)
          │    │   │      │    │              │        │    │           └ <function StapledObjectStream.send at 0x0000028462A6A0C0>
          │    │   │      │    │              │        │    └ StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamState(max_buffer_size=inf, buffer=deque([]),...
          │    │   │      │    │              │        └ <starlette.testclient.TestClient object at 0x0000028464EBFB60>
          │    │   │      │    │              └ <function StapledObjectStream.receive at 0x0000028462A69EE0>
          │    │   │      │    └ StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamState(max_buffer_size=inf, buffer=deque([]),...
          │    │   │      └ <starlette.testclient.TestClient object at 0x0000028464EBFB60>
          │    │   └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
          └ <starlette.testclient.TestClient object at 0x0000028464EBFB60>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
                           │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
                           └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │                │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │                └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │   │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │   └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │   │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │   └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │   │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │   └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │                │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │                └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │        │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │        └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <function Router.lifespan at 0x0000028463BFBF60>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000284651D34C0>
               └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000284651F47B0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000284652217F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000284651D2340>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000284651F48C0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000002846518FED0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
               └ <function lifespan at 0x000002846516AFC0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x00000284651E18A0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000002846518FB10>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x0000028465169940>
       └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x0000028465206880>
                └ <contextlib._GeneratorContextManager object at 0x000002846520D780>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x0000028465221940>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:35 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle Task.task_wakeup()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object TestClient.lifespan at 0x0000028465206420>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\testclient.py", line 704, in lifespan
    await self.app(scope, self.stream_receive.receive, self.stream_send.send)
          │    │   │      │    │              │        │    │           └ <function StapledObjectStream.send at 0x0000028462A6A0C0>
          │    │   │      │    │              │        │    └ StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamState(max_buffer_size=inf, buffer=deque([]),...
          │    │   │      │    │              │        └ <starlette.testclient.TestClient object at 0x0000028464EBFB60>
          │    │   │      │    │              └ <function StapledObjectStream.receive at 0x0000028462A69EE0>
          │    │   │      │    └ StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamState(max_buffer_size=inf, buffer=deque([]),...
          │    │   │      └ <starlette.testclient.TestClient object at 0x0000028464EBFB60>
          │    │   └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
          └ <starlette.testclient.TestClient object at 0x0000028464EBFB60>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
                           │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
                           └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │                │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │                └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 151, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │   │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │   └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 49, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │   │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │   └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │   │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │   └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │                │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │                └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 725, in app
    await self.lifespan(scope, receive, send)
          │    │        │      │        └ <bound method StapledObjectStream.send of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStreamSt...
          │    │        │      └ <bound method StapledObjectStream.receive of StapledObjectStream(send_stream=MemoryObjectSendStream(_state=_MemoryObjectStrea...
          │    │        └ {'type': 'lifespan', 'state': {}, 'app': <fastapi.applications.FastAPI object at 0x0000028464EBF620>, 'fastapi_middleware_ast...
          │    └ <function Router.lifespan at 0x0000028463BFBF60>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               │    │                └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
               │    └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000284651D34C0>
               └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000284651F47B0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x00000284652217F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
               └ <function _merge_lifespan_context.<locals>.merged_lifespan at 0x00000284651D2340>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object _merge_lifespan_context.<locals>.merged_lifespan at 0x00000284651F48C0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000002846518FED0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 206, in merged_lifespan
    async with original_context(app) as maybe_original_state:
               │                └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
               └ <function lifespan at 0x000002846516AFC0>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
                       │    └ <async_generator object lifespan at 0x00000284651E18A0>
                       └ <contextlib._AsyncGeneratorContextManager object at 0x000002846518FB10>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 20, in lifespan
    if db.test_connection():
       │  └ <function DatabaseConnection.test_connection at 0x0000028465169940>
       └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x0000028465206880>
                └ <contextlib._GeneratorContextManager object at 0x000002846520D780>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x0000028465221940>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:35 | ERROR    | app:lifespan:23 - Database connection failed
2025-12-11 11:18:35 | INFO     | app:lifespan:25 - Loading models...
2025-12-11 11:18:37 | SUCCESS  | app:lifespan:27 - Models loaded successfully.
2025-12-11 11:18:37 | INFO     | app:lifespan:30 - Initializing services...
2025-12-11 11:18:37 | SUCCESS  | app:lifespan:36 - Services initialized successfully.
2025-12-11 11:18:41 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028465208E20>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028465208E20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028465208E20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028465208E20>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DAD40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284183BC540>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284183BC540>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284183BD800>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284183BD800>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    │    └ <starlette.requests.Request object at 0x00000284183E0A50>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <function request_response.<locals>.app at 0x00000284651D3A60>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    └ <starlette.requests.Request object at 0x00000284182FB100>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000284183BDA80>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BDBC0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000284183BDA80>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000284182FB100>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D39C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {}
                 │         └ <function health at 0x00000284651D3880>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 63, in health
    "database_connected": db.test_connection(),
                          │  └ <function DatabaseConnection.test_connection at 0x0000028465169940>
                          └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841839F300>
                └ <contextlib._GeneratorContextManager object at 0x000002841D3D1780>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1310>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:41 | ERROR    | core.database:test_connection:121 - Database connection test failed: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028465208E20>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028465208E20>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028465208E20>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028465208E20>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DAD40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284183BC540>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284183BC540>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284183BD800>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284183BD800>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    │    └ <starlette.requests.Request object at 0x00000284183E0A50>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │    └ <function request_response.<locals>.app at 0x00000284651D3A60>
          └ APIRoute(path='/health', name='health', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BD9E0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          │                            │    └ <starlette.requests.Request object at 0x00000284182FB100>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000284183BDA80>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BDBC0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284651FE7A0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/health', 'raw_path': b'/health', 'root_path': '', 'scheme'...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000284183BDA80>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000284182FB100>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D39C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {}
                 │         └ <function health at 0x00000284651D3880>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\app.py", line 63, in health
    "database_connected": db.test_connection(),
                          │  └ <function DatabaseConnection.test_connection at 0x0000028465169940>
                          └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 114, in test_connection
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841839F300>
                └ <contextlib._GeneratorContextManager object at 0x000002841D3D1780>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1310>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:41 | ERROR    | services.encoder_service:encode_finalgrade:19 - Final grade label encoder is not loaded
NoneType: None
2025-12-11 11:18:41 | ERROR    | api.router:predict_final_result:46 - Error predicting final result: Final grade label encoder is not loaded
Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183AF460>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183AF460>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183AF460>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183AF460>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DB100>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284183BD8A0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDF80>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284183BD8A0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDF80>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284183BE0C0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDF80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284183BE0C0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDF80>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    │    └ <starlette.requests.Request object at 0x00000284183A9BF0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BE200>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDF80>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BE200>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDF80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BE200>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDF80>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BE200>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDF80>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BE200>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDF80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <function request_response.<locals>.app at 0x00000284651D1C60>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BE200>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDF80>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    └ <starlette.requests.Request object at 0x00000284183A9E10>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000284183BE2A0>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000284183BE520>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDF80>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000284183BE2A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000284183A9E10>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D1B20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': FinalResultRequest(gender='M', age_band='35-55', studied_credits=120, num_of_prev_attempts=0, total_clicks=1500, avg...
                 │         └ <function predict_final_result at 0x000002846516B740>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 32, in predict_final_result
    encoded_features = request.app.state.encoder_service.encode_finalgrade(features)
                       │       │                                           └ {'gender': 'M', 'age_band': '35-55', 'studied_credits': 120, 'num_of_prev_attempts': 0, 'total_clicks': 1500, 'avg_assessment...
                       │       └ <property object at 0x0000028463B46890>
                       └ <starlette.requests.Request object at 0x00000284183A9E10>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\encoder_service.py", line 20, in encode_finalgrade
    raise Exception("Final grade label encoder is not loaded")

Exception: Final grade label encoder is not loaded
2025-12-11 11:18:41 | ERROR    | services.encoder_service:encode_dropout:33 - Dropout label encoder is not loaded
NoneType: None
2025-12-11 11:18:41 | ERROR    | api.router:predict_dropout:85 - Error predicting dropout: Dropout label encoder is not loaded
Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028416FF2BC0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028416FF2BC0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028416FF2BC0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028416FF2BC0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DB010>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284183BDBC0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BD9E0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284183BDBC0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BD9E0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002841D46C0E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BD9E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002841D46C0E0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BD9E0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841835AA50>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002841D46C220>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BD9E0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002841D46C220>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BD9E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002841D46C220>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BD9E0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002841D46C220>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BD9E0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/predict/dropout', name='predict_dropout', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002841D46C220>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BD9E0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │    └ <function request_response.<locals>.app at 0x00000284651D20C0>
          └ APIRoute(path='/api/predict/dropout', name='predict_dropout', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002841D46C220>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BD9E0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          │                            │    └ <starlette.requests.Request object at 0x000002841835A550>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002841D46C2C0>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002841D46C400>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BD9E0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/dropout', 'raw_path': b'/api/predict/dropout'...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002841D46C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841835A550>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D2020>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': DropoutRequest(code_module='AAA', code_presentation='2013J', gender='F', region='East Anglian Region', highest_educa...
                 │         └ <function predict_dropout at 0x000002846516BA60>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 71, in predict_dropout
    encoded_features = request.app.state.encoder_service.encode_dropout(features)
                       │       │                                        └ {'code_module': 'AAA', 'code_presentation': '2013J', 'gender': 'F', 'region': 'East Anglian Region', 'highest_education': 'HE...
                       │       └ <property object at 0x0000028463B46890>
                       └ <starlette.requests.Request object at 0x000002841835A550>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\encoder_service.py", line 34, in encode_dropout
    raise Exception("Dropout label encoder is not loaded")

Exception: Dropout label encoder is not loaded
2025-12-11 11:18:45 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DBC40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D46CC90>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <function request_response.<locals>.app at 0x00000284651D2700>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    └ <starlette.requests.Request object at 0x000002841D46CE50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048D60>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D46CE50>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D25C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D46CE50>}
                 │         └ <function get_dashboard_overview at 0x00000284651D0360>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 22, in get_dashboard_overview
    overview = kpi_service.get_dashboard_overview()
               │           └ <function KPIService.get_dashboard_overview at 0x000002846516B380>
               └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 157, in get_dashboard_overview
    "student_performance": self.get_student_performance_summary(),
                           │    └ <function KPIService.get_student_performance_summary at 0x000002846516B100>
                           └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 61, in get_student_performance_summary
    result = db.execute_one(query)
             │  │           └ "\n            SELECT \n                COUNT(*) as total_students,\n                AVG(studied_credits) as avg_credits,\n  ...
             │  └ <function DatabaseConnection.execute_one at 0x0000028465169800>
             └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 80, in execute_one
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46D000>
                └ <contextlib._GeneratorContextManager object at 0x000002841D478600>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E0690>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:45 | ERROR    | services.kpi_service:get_student_performance_summary:65 - Error getting student performance: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DBC40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D46CC90>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <function request_response.<locals>.app at 0x00000284651D2700>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    └ <starlette.requests.Request object at 0x000002841D46CE50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048D60>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D46CE50>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D25C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D46CE50>}
                 │         └ <function get_dashboard_overview at 0x00000284651D0360>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 22, in get_dashboard_overview
    overview = kpi_service.get_dashboard_overview()
               │           └ <function KPIService.get_dashboard_overview at 0x000002846516B380>
               └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 157, in get_dashboard_overview
    "student_performance": self.get_student_performance_summary(),
                           │    └ <function KPIService.get_student_performance_summary at 0x000002846516B100>
                           └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 61, in get_student_performance_summary
    result = db.execute_one(query)
             │  │           └ "\n            SELECT \n                COUNT(*) as total_students,\n                AVG(studied_credits) as avg_credits,\n  ...
             │  └ <function DatabaseConnection.execute_one at 0x0000028465169800>
             └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 80, in execute_one
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46D000>
                └ <contextlib._GeneratorContextManager object at 0x000002841D478600>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E0690>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:49 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DBC40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D46CC90>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <function request_response.<locals>.app at 0x00000284651D2700>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    └ <starlette.requests.Request object at 0x000002841D46CE50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048D60>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D46CE50>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D25C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D46CE50>}
                 │         └ <function get_dashboard_overview at 0x00000284651D0360>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 22, in get_dashboard_overview
    overview = kpi_service.get_dashboard_overview()
               │           └ <function KPIService.get_dashboard_overview at 0x000002846516B380>
               └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 158, in get_dashboard_overview
    "vle_engagement": self.get_vle_engagement_summary(),
                      │    └ <function KPIService.get_vle_engagement_summary at 0x000002846516B2E0>
                      └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 141, in get_vle_engagement_summary
    result = db.execute_one(query)
             │  │           └ '\n            SELECT \n                COUNT(DISTINCT id_student) as total_active_students,\n                SUM(sum_click) ...
             │  └ <function DatabaseConnection.execute_one at 0x0000028465169800>
             └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 80, in execute_one
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46D0E0>
                └ <contextlib._GeneratorContextManager object at 0x000002841D479080>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:49 | ERROR    | services.kpi_service:get_vle_engagement_summary:145 - Error getting VLE engagement: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DBC40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D46CC90>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <function request_response.<locals>.app at 0x00000284651D2700>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    └ <starlette.requests.Request object at 0x000002841D46CE50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048D60>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D46CE50>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D25C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D46CE50>}
                 │         └ <function get_dashboard_overview at 0x00000284651D0360>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 22, in get_dashboard_overview
    overview = kpi_service.get_dashboard_overview()
               │           └ <function KPIService.get_dashboard_overview at 0x000002846516B380>
               └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 158, in get_dashboard_overview
    "vle_engagement": self.get_vle_engagement_summary(),
                      │    └ <function KPIService.get_vle_engagement_summary at 0x000002846516B2E0>
                      └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 141, in get_vle_engagement_summary
    result = db.execute_one(query)
             │  │           └ '\n            SELECT \n                COUNT(DISTINCT id_student) as total_active_students,\n                SUM(sum_click) ...
             │  └ <function DatabaseConnection.execute_one at 0x0000028465169800>
             └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 80, in execute_one
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46D0E0>
                └ <contextlib._GeneratorContextManager object at 0x000002841D479080>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1590>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:53 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DBC40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D46CC90>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <function request_response.<locals>.app at 0x00000284651D2700>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    └ <starlette.requests.Request object at 0x000002841D46CE50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048D60>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D46CE50>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D25C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D46CE50>}
                 │         └ <function get_dashboard_overview at 0x00000284651D0360>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 22, in get_dashboard_overview
    overview = kpi_service.get_dashboard_overview()
               │           └ <function KPIService.get_dashboard_overview at 0x000002846516B380>
               └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 159, in get_dashboard_overview
    "module_statistics": self.get_module_statistics(),
                         │    └ <function KPIService.get_module_statistics at 0x000002846516B1A0>
                         └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 90, in get_module_statistics
    results = db.execute_query(query)
              │  │             └ "\n            SELECT \n                code_module,\n                code_presentation,\n                COUNT(*) as total_s...
              │  └ <function DatabaseConnection.execute_query at 0x0000028465169760>
              └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 62, in execute_query
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46D2A0>
                └ <contextlib._GeneratorContextManager object at 0x000002841D479400>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1310>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:53 | ERROR    | services.kpi_service:get_module_statistics:94 - Error getting module statistics: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DBC40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D46CC90>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <function request_response.<locals>.app at 0x00000284651D2700>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    └ <starlette.requests.Request object at 0x000002841D46CE50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048D60>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D46CE50>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D25C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D46CE50>}
                 │         └ <function get_dashboard_overview at 0x00000284651D0360>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 22, in get_dashboard_overview
    overview = kpi_service.get_dashboard_overview()
               │           └ <function KPIService.get_dashboard_overview at 0x000002846516B380>
               └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 159, in get_dashboard_overview
    "module_statistics": self.get_module_statistics(),
                         │    └ <function KPIService.get_module_statistics at 0x000002846516B1A0>
                         └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 90, in get_module_statistics
    results = db.execute_query(query)
              │  │             └ "\n            SELECT \n                code_module,\n                code_presentation,\n                COUNT(*) as total_s...
              │  └ <function DatabaseConnection.execute_query at 0x0000028465169760>
              └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 62, in execute_query
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46D2A0>
                └ <contextlib._GeneratorContextManager object at 0x000002841D479400>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1310>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:57 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DBC40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D46CC90>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <function request_response.<locals>.app at 0x00000284651D2700>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    └ <starlette.requests.Request object at 0x000002841D46CE50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048D60>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D46CE50>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D25C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D46CE50>}
                 │         └ <function get_dashboard_overview at 0x00000284651D0360>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 22, in get_dashboard_overview
    overview = kpi_service.get_dashboard_overview()
               │           └ <function KPIService.get_dashboard_overview at 0x000002846516B380>
               └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 160, in get_dashboard_overview
    "assessment_summary": self.get_assessment_summary()
                          │    └ <function KPIService.get_assessment_summary at 0x000002846516B240>
                          └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 117, in get_assessment_summary
    results = db.execute_query(query)
              │  │             └ '\n            SELECT \n                sa.code_module,\n                sa.code_presentation,\n                COUNT(DISTINC...
              │  └ <function DatabaseConnection.execute_query at 0x0000028465169760>
              └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 62, in execute_query
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46DA80>
                └ <contextlib._GeneratorContextManager object at 0x000002841D479630>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E0CD0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:57 | ERROR    | services.kpi_service:get_assessment_summary:121 - Error getting assessment summary: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D4C70>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DBC40>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340487C0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340489A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D46CC90>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │    └ <function request_response.<locals>.app at 0x00000284651D2700>
          └ APIRoute(path='/api/kpi/overview', name='get_dashboard_overview', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048AE0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          │                            │    └ <starlette.requests.Request object at 0x000002841D46CE50>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434048D60>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/overview', 'raw_path': b'/api/kpi/overview', 'root...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434048C20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D46CE50>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D25C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D46CE50>}
                 │         └ <function get_dashboard_overview at 0x00000284651D0360>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 22, in get_dashboard_overview
    overview = kpi_service.get_dashboard_overview()
               │           └ <function KPIService.get_dashboard_overview at 0x000002846516B380>
               └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 160, in get_dashboard_overview
    "assessment_summary": self.get_assessment_summary()
                          │    └ <function KPIService.get_assessment_summary at 0x000002846516B240>
                          └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 117, in get_assessment_summary
    results = db.execute_query(query)
              │  │             └ '\n            SELECT \n                sa.code_module,\n                sa.code_presentation,\n                COUNT(DISTINC...
              │  └ <function DatabaseConnection.execute_query at 0x0000028465169760>
              └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 62, in execute_query
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46DA80>
                └ <contextlib._GeneratorContextManager object at 0x000002841D479630>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E0CD0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:18:57 | INFO     | services.kpi_service:get_dashboard_overview:162 - Retrieved complete dashboard overview
2025-12-11 11:19:02 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D6290>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D6290>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D6290>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D6290>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DBF10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000028434049260>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000028434049260>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340493A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340493A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D460460>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/student-performance', name='get_student_performance', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <function request_response.<locals>.app at 0x00000284651D2A20>
          └ APIRoute(path='/api/kpi/student-performance', name='get_student_performance', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │                            │    └ <starlette.requests.Request object at 0x000002841D454290>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434049620>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049760>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434049620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D454290>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D28E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D454290>}
                 │         └ <function get_student_performance at 0x00000284651D0680>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 37, in get_student_performance
    data = kpi_service.get_student_performance_summary()
           │           └ <function KPIService.get_student_performance_summary at 0x000002846516B100>
           └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 61, in get_student_performance_summary
    result = db.execute_one(query)
             │  │           └ "\n            SELECT \n                COUNT(*) as total_students,\n                AVG(studied_credits) as avg_credits,\n  ...
             │  └ <function DatabaseConnection.execute_one at 0x0000028465169800>
             └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 80, in execute_one
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46E180>
                └ <contextlib._GeneratorContextManager object at 0x000002841D4796A0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1090>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:19:02 | ERROR    | services.kpi_service:get_student_performance_summary:65 - Error getting student performance: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D6290>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D6290>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D6290>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183D6290>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DBF10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000028434049260>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000028434049260>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340493A0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000284340493A0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D460460>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/student-performance', name='get_student_performance', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │    └ <function request_response.<locals>.app at 0x00000284651D2A20>
          └ APIRoute(path='/api/kpi/student-performance', name='get_student_performance', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049580>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          │                            │    └ <starlette.requests.Request object at 0x000002841D454290>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434049620>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049760>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048900>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/student-performance', 'raw_path': b'/api/kpi/stude...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434049620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D454290>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D28E0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D454290>}
                 │         └ <function get_student_performance at 0x00000284651D0680>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 37, in get_student_performance
    data = kpi_service.get_student_performance_summary()
           │           └ <function KPIService.get_student_performance_summary at 0x000002846516B100>
           └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 61, in get_student_performance_summary
    result = db.execute_one(query)
             │  │           └ "\n            SELECT \n                COUNT(*) as total_students,\n                AVG(studied_credits) as avg_credits,\n  ...
             │  └ <function DatabaseConnection.execute_one at 0x0000028465169800>
             └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 80, in execute_one
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46E180>
                └ <contextlib._GeneratorContextManager object at 0x000002841D4796A0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1090>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:19:06 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183ED0C0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183ED0C0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183ED0C0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183ED0C0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D464A90>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340498A0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340498A0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000028434049800>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000028434049800>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D454890>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/module-statistics', name='get_module_statistics', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <function request_response.<locals>.app at 0x00000284651D2D40>
          └ APIRoute(path='/api/kpi/module-statistics', name='get_module_statistics', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │                            │    └ <starlette.requests.Request object at 0x000002841D44D4F0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434049C60>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049DA0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434049C60>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D44D4F0>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D2C00>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D44D4F0>}
                 │         └ <function get_module_statistics at 0x00000284651D09A0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 52, in get_module_statistics
    data = kpi_service.get_module_statistics()
           │           └ <function KPIService.get_module_statistics at 0x000002846516B1A0>
           └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 90, in get_module_statistics
    results = db.execute_query(query)
              │  │             └ "\n            SELECT \n                code_module,\n                code_presentation,\n                COUNT(*) as total_s...
              │  └ <function DatabaseConnection.execute_query at 0x0000028465169760>
              └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 62, in execute_query
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46E6C0>
                └ <contextlib._GeneratorContextManager object at 0x000002841D4792B0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E07D0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:19:06 | ERROR    | services.kpi_service:get_module_statistics:94 - Error getting module statistics: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183ED0C0>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183ED0C0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183ED0C0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284183ED0C0>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D464A90>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340498A0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284340498A0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000028434049800>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000028434049800>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D454890>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/module-statistics', name='get_module_statistics', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │    └ <function request_response.<locals>.app at 0x00000284651D2D40>
          └ APIRoute(path='/api/kpi/module-statistics', name='get_module_statistics', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049940>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          │                            │    └ <starlette.requests.Request object at 0x000002841D44D4F0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000028434049C60>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049DA0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434049B20>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/module-statistics', 'raw_path': b'/api/kpi/module-...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000028434049C60>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D44D4F0>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D2C00>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D44D4F0>}
                 │         └ <function get_module_statistics at 0x00000284651D09A0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 52, in get_module_statistics
    data = kpi_service.get_module_statistics()
           │           └ <function KPIService.get_module_statistics at 0x000002846516B1A0>
           └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 90, in get_module_statistics
    results = db.execute_query(query)
              │  │             └ "\n            SELECT \n                code_module,\n                code_presentation,\n                COUNT(*) as total_s...
              │  └ <function DatabaseConnection.execute_query at 0x0000028465169760>
              └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 62, in execute_query
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46E6C0>
                └ <contextlib._GeneratorContextManager object at 0x000002841D4792B0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E07D0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:19:10 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418409270>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418409270>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418409270>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418409270>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D4653F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000028434049EE0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000028434049EE0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000028434049E40>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000028434049E40>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D44D860>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/vle-engagement', name='get_vle_engagement', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <function request_response.<locals>.app at 0x00000284651D3060>
          └ APIRoute(path='/api/kpi/vle-engagement', name='get_vle_engagement', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │                            │    └ <starlette.requests.Request object at 0x000002841D44DA70>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002843404A2A0>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A3E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002843404A2A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D44DA70>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D2F20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D44DA70>}
                 │         └ <function get_vle_engagement at 0x00000284651D0D60>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 67, in get_vle_engagement
    data = kpi_service.get_vle_engagement_summary()
           │           └ <function KPIService.get_vle_engagement_summary at 0x000002846516B2E0>
           └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 141, in get_vle_engagement_summary
    result = db.execute_one(query)
             │  │           └ '\n            SELECT \n                COUNT(DISTINCT id_student) as total_active_students,\n                SUM(sum_click) ...
             │  └ <function DatabaseConnection.execute_one at 0x0000028465169800>
             └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 80, in execute_one
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46E7A0>
                └ <contextlib._GeneratorContextManager object at 0x000002841D479B70>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:19:10 | ERROR    | services.kpi_service:get_vle_engagement_summary:145 - Error getting VLE engagement: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418409270>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418409270>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418409270>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418409270>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D4653F0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000028434049EE0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x0000028434049EE0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000028434049E40>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000028434049E40>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D44D860>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/vle-engagement', name='get_vle_engagement', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │    └ <function request_response.<locals>.app at 0x00000284651D3060>
          └ APIRoute(path='/api/kpi/vle-engagement', name='get_vle_engagement', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000028434049F80>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          │                            │    └ <starlette.requests.Request object at 0x000002841D44DA70>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002843404A2A0>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A3E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x0000028434048860>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/vle-engagement', 'raw_path': b'/api/kpi/vle-engage...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002843404A2A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D44DA70>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D2F20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D44DA70>}
                 │         └ <function get_vle_engagement at 0x00000284651D0D60>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 67, in get_vle_engagement
    data = kpi_service.get_vle_engagement_summary()
           │           └ <function KPIService.get_vle_engagement_summary at 0x000002846516B2E0>
           └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 141, in get_vle_engagement_summary
    result = db.execute_one(query)
             │  │           └ '\n            SELECT \n                COUNT(DISTINCT id_student) as total_active_students,\n                SUM(sum_click) ...
             │  └ <function DatabaseConnection.execute_one at 0x0000028465169800>
             └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 80, in execute_one
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46E7A0>
                └ <contextlib._GeneratorContextManager object at 0x000002841D479B70>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1D10>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:19:14 | ERROR    | core.database:get_connection:44 - Database connection error: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418425330>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418425330>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418425330>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418425330>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D4664D0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x000002843404A700>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x000002843404A700>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002843404A660>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002843404A660>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D44DBD0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/assessment-summary', name='get_assessment_summary', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <function request_response.<locals>.app at 0x00000284651D3380>
          └ APIRoute(path='/api/kpi/assessment-summary', name='get_assessment_summary', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │                            │    └ <starlette.requests.Request object at 0x000002841D44DC80>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002843404A980>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404AAC0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002843404A980>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D44DC80>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D3240>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D44DC80>}
                 │         └ <function get_assessment_summary at 0x00000284651D1120>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 82, in get_assessment_summary
    data = kpi_service.get_assessment_summary()
           │           └ <function KPIService.get_assessment_summary at 0x000002846516B240>
           └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 117, in get_assessment_summary
    results = db.execute_query(query)
              │  │             └ '\n            SELECT \n                sa.code_module,\n                sa.code_presentation,\n                COUNT(DISTINC...
              │  └ <function DatabaseConnection.execute_query at 0x0000028465169760>
              └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 62, in execute_query
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46EA40>
                └ <contextlib._GeneratorContextManager object at 0x000002841D479CC0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1BD0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:19:14 | ERROR    | services.kpi_service:get_assessment_summary:121 - Error getting assessment summary: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
Traceback (most recent call last):

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 661, in connect
    sock = socket.create_connection(
           │      └ <function create_connection at 0x00000284610E5BC0>
           └ <module 'socket' from 'C:\\Users\\LENOVO\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\socket.py'>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 864, in create_connection
    raise exceptions[0]
          └ []
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\socket.py", line 849, in create_connection
    sock.connect(sa)
    │    │       └ ('127.0.0.1', 3008)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418425330>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418425330>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418425330>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418425330>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D4664D0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x000002843404A700>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x000002843404A700>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002843404A660>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002843404A660>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D44DBD0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/kpi/assessment-summary', name='get_assessment_summary', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │    └ <function request_response.<locals>.app at 0x00000284651D3380>
          └ APIRoute(path='/api/kpi/assessment-summary', name='get_assessment_summary', methods=['GET'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404A8E0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          │                            │    └ <starlette.requests.Request object at 0x000002841D44DC80>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002843404A980>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404AAC0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404A520>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/kpi/assessment-summary', 'raw_path': b'/api/kpi/assess...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002843404A980>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D44DC80>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D3240>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'request': <starlette.requests.Request object at 0x000002841D44DC80>}
                 │         └ <function get_assessment_summary at 0x00000284651D1120>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[], name=None, ca...

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\kpi_router.py", line 82, in get_assessment_summary
    data = kpi_service.get_assessment_summary()
           │           └ <function KPIService.get_assessment_summary at 0x000002846516B240>
           └ <services.kpi_service.KPIService object at 0x0000028464EBEBA0>

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\kpi_service.py", line 117, in get_assessment_summary
    results = db.execute_query(query)
              │  │             └ '\n            SELECT \n                sa.code_module,\n                sa.code_presentation,\n                COUNT(DISTINC...
              │  └ <function DatabaseConnection.execute_query at 0x0000028465169760>
              └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 62, in execute_query
    with self.get_connection() as conn:
         │    └ <function DatabaseConnection.get_connection at 0x00000284651696C0>
         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\contextlib.py", line 141, in __enter__
    return next(self.gen)
                │    └ <generator object DatabaseConnection.get_connection at 0x000002841D46EA40>
                └ <contextlib._GeneratorContextManager object at 0x000002841D479CC0>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\core\database.py", line 40, in get_connection
    connection = pymysql.connect(**self.config)
                 │       │         │    └ {'host': 'localhost', 'port': 3008, 'user': 'root', 'password': '', 'database': 'capstone_kpi', 'cursorclass': <class 'pymysq...
                 │       │         └ <core.database.DatabaseConnection object at 0x0000028464EBE510>
                 │       └ <class 'pymysql.connections.Connection'>
                 └ <module 'pymysql' from 'D:\\Kuliah\\Semt 7\\Capstone\\capstone-backend\\.venv\\Lib\\site-packages\\pymysql\\__init__.py'>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 365, in __init__
    self.connect()
    │    └ <function Connection.connect at 0x00000284651680E0>
    └ <pymysql.connections.Connection object at 0x00000284183E1BD0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\pymysql\connections.py", line 723, in connect
    raise exc
          └ OperationalError(2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because th...

pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([WinError 10061] No connection could be made because the target machine actively refused it)")
2025-12-11 11:19:14 | ERROR    | services.encoder_service:encode_finalgrade:19 - Final grade label encoder is not loaded
NoneType: None
2025-12-11 11:19:14 | ERROR    | api.router:predict_final_result:46 - Error predicting final result: Final grade label encoder is not loaded
Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002841847AD40>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002841847AD40>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002841847AD40>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002841847AD40>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D484E50>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x000002843404BBA0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404BA60>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x000002843404BBA0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404BA60>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002843404BD80>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404BA60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002843404BD80>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404BA60>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D44EDB0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404BEC0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404BA60>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404BEC0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404BA60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404BEC0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404BA60>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404BEC0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404BA60>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404BEC0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404BA60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <function request_response.<locals>.app at 0x00000284651D1C60>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404BEC0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404BA60>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    └ <starlette.requests.Request object at 0x000002841D44EE60>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002843404BF60>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002841D4580E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x000002843404BA60>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002843404BF60>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D44EE60>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D1B20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': FinalResultRequest(gender='M', age_band='35-55', studied_credits=999999, num_of_prev_attempts=100, total_clicks=1000...
                 │         └ <function predict_final_result at 0x000002846516B740>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 32, in predict_final_result
    encoded_features = request.app.state.encoder_service.encode_finalgrade(features)
                       │       │                                           └ {'gender': 'M', 'age_band': '35-55', 'studied_credits': 999999, 'num_of_prev_attempts': 100, 'total_clicks': 1000000, 'avg_as...
                       │       └ <property object at 0x0000028463B46890>
                       └ <starlette.requests.Request object at 0x000002841D44EE60>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\encoder_service.py", line 20, in encode_finalgrade
    raise Exception("Final grade label encoder is not loaded")

Exception: Final grade label encoder is not loaded
2025-12-11 11:19:14 | ERROR    | services.encoder_service:encode_finalgrade:19 - Final grade label encoder is not loaded
NoneType: None
2025-12-11 11:19:14 | ERROR    | api.router:predict_final_result:46 - Error predicting final result: Final grade label encoder is not loaded
Traceback (most recent call last):

  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1012, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002846060D4E0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 1041, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002846060D260>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 992, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x00000284651FD8A0>
    └ <Thread(asyncio-portal-28465220c20, started daemon 6036)>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 524, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x000002846108C2C0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_core\_eventloop.py", line 75, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FD800>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x00000284633FCCC0>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2365, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x00000284651FDA80>
           │      └ <function Runner.run at 0x0000028463384860>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000284633822A0>
           │    └ <ProactorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000028465220830>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 708, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000028463382200>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 679, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000028463384040>
    └ <ProactorEventLoop running=True closed=False debug=False>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 2027, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000028462AF9760>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418447D60>()>
  File "C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418447D60>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418447D60>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000028418447D60>()>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\anyio\from_thread.py", line 257, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x000002841D3DA980>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284183BD9E0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDC60>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x00000284183BD9E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDC60>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
          └ <fastapi.applications.FastAPI object at 0x0000028464EBF620>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002843404ADE0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDC60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000284652216A0>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002843404ADE0>
          │                            │    │    │     │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDC60>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    │    └ <starlette.requests.Request object at 0x000002841D44E2B0>
          │                            │    └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000028465221550>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404B2E0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDC60>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404B2E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDC60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <fastapi.routing.APIRouter object at 0x0000028465181810>
          └ <fastapi.middleware.asyncexitstack.AsyncExitStackMiddleware object at 0x0000028465221400>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404B2E0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDC60>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000028465181810>>
          └ <fastapi.routing.APIRouter object at 0x0000028465181810>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404B2E0>
          │     │      │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDC60>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │     └ <function Route.handle at 0x0000028463BFA8E0>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404B2E0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDC60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │    └ <function request_response.<locals>.app at 0x00000284651D1C60>
          └ APIRoute(path='/api/predict/final-result', name='predict_final_result', methods=['POST'])
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404B2E0>
          │                            │    │        │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDC60>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          │                            │    └ <starlette.requests.Request object at 0x000002841D44E410>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002843404B380>
          └ <function wrap_app_handling_exceptions at 0x0000028463BF9120>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002843404B6A0>
          │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x00000284183BDC60>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/predict/final-result', 'raw_path': b'/api/predict/fin...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002843404B380>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002841D44E410>
                     └ <function get_request_handler.<locals>.app at 0x00000284651D1B20>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 430, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000028463C1C860>
  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\.venv\Lib\site-packages\fastapi\routing.py", line 316, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'body': FinalResultRequest(gender='M', age_band='35-55', studied_credits=120, num_of_prev_attempts=0, total_clicks=1500, avg...
                 │         └ <function predict_final_result at 0x000002846516B740>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

> File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\api\router.py", line 32, in predict_final_result
    encoded_features = request.app.state.encoder_service.encode_finalgrade(features)
                       │       │                                           └ {'gender': 'M', 'age_band': '35-55', 'studied_credits': 120, 'num_of_prev_attempts': 0, 'total_clicks': 1500, 'avg_assessment...
                       │       └ <property object at 0x0000028463B46890>
                       └ <starlette.requests.Request object at 0x000002841D44E410>

  File "D:\Kuliah\Semt 7\Capstone\capstone-backend\src\services\encoder_service.py", line 20, in encode_finalgrade
    raise Exception("Final grade label encoder is not loaded")

Exception: Final grade label encoder is not loaded
2025-12-11 11:19:14 | INFO     | app:lifespan:41 - Shutting down the application...
